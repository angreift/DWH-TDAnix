<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="5/23/2022 10:02:48 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="S19-BI-DB"
  DTS:CreatorName="TDANIX\kma1860"
  DTS:DTSID="{5F04560D-A468-44A5-A84A-8359F5C6CE51}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.170"
  DTS:LocaleID="1049"
  DTS:ObjectName="1822"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="58"
  DTS:VersionGUID="{790FB5FC-5732-4F91-860C-8E7901E529E0}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[s19-olap.DWH]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{05C4BFB3-5D42-4E9A-8990-A3A0AAD6CA80}"
      DTS:ObjectName="s19-olap.DWH">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=s19-olap;Initial Catalog=DWH;Integrated Security=True;Application Name=SSIS-1822-{05C4BFB3-5D42-4E9A-8990-A3A0AAD6CA80}s19-olap.DWH;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[S19-STORAGE-SQL.CS.reader]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{97220118-FEE3-405C-9A2C-E83EF32260D2}"
      DTS:ObjectName="S19-STORAGE-SQL.CS.reader">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=S19-STORAGE-SQL;Initial Catalog=CS;Integrated Security=True;Application Name=SSIS-Package-{97220118-FEE3-405C-9A2C-E83EF32260D2}S19-STORAGE-SQL.CS.reader;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
      DTS:ObjectName="S19-STORAGE-SQL.ERP_reports.reader">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=S19-STORAGE-SQL;Initial Catalog=ERP_reports;Integrated Security=True;Application Name=SSIS-Package-{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}S19-STORAGE-SQL.ERP_reports.reader;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[s8-olap-test.olap-rozn.reader]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{B2E817E9-F0AE-41E2-9455-4F4D6B190E22}"
      DTS:ObjectName="s8-olap-test.olap-rozn.reader">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=s19-olap;Initial Catalog=olap-rozn;Integrated Security=True;Application Name=SSIS-Package-{B2E817E9-F0AE-41E2-9455-4F4D6B190E22}s8-olap-test.olap-rozn.reader;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[serv-term.rozn.reader]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{8BC5E170-3478-4D9E-BE3F-3318FB3D6C41}"
      DTS:ObjectName="serv-term.rozn.reader">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=serv-term;Initial Catalog=rozn;Integrated Security=True;Application Name=SSIS-Package-{8BC5E170-3478-4D9E-BE3F-3318FB3D6C41}serv-term.rozn.reader;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Загрузка фактов"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{2004D3A9-F470-47DB-8904-0A1821EF9586}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Загрузка фактов"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Загрузка фактов\Сбор данных"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
              description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
              name="Сбор данных"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">select 
	cast(dateadd(day, -1, getdate()) as date) Дата,
	Товары.КодТовара, 
	Остатки.Остаток, 
	ОстаткиРуб.Стоимость, 
	case when СредниеПродажи.продажи is null or СредниеПродажи.продажи = 0 then null else cast(СредниеОстатки.Остаток / СредниеПродажи.Продажи as numeric(18,3)) end ОборачиваемостьДней,
	Потери.СуммаПотерь,
	--Продажи.Продажи,
	case when Продажи.Продажи is null or Продажи.Продажи = 0 then null else cast( Потери.СуммаПотерь / Продажи.Продажи * 100 as numeric(18,3)) end ПотериПроц,
	Переоценка.СуммаПереоценки ПереоценкаРуб,
	case when Продажи.Продажи is null or Продажи.Продажи = 0 then null else cast( Переоценка.СуммаПереоценки / Продажи.Продажи * 100 as numeric(18,3)) end ПереоценкаПроц
	from
( --Список товаров из всех источников, отображаем минимальную инфу, которую удалось получить
select distinct КодТовара from [1822_avg_bal]
union
select distinct КодТовара from [1822_avg_sales]
union
select distinct КодТовара from [1822_balance_value]
union
select distinct КодТовара from [1822_sales]
union
select distinct КодТовара from [1822_sum_loses] 
union
select distinct КодТовара from [1822_sum_reval] 
union
select distinct КодТовара from [1822_balance]
) Товары

left join [1822_balance] Остатки on Товары.КодТовара = Остатки.КодТовара
left join [1822_balance_value] ОстаткиРуб on Товары.КодТовара = ОстаткиРуб.КодТовара
left join [1822_avg_bal] СредниеОстатки on Товары.КодТовара = СредниеОстатки.КодТовара
left join [1822_avg_sales] СредниеПродажи on Товары.КодТовара = СредниеПродажи.КодТовара
left join [1822_sum_loses] Потери on Товары.КодТовара = Потери.КодТовара
left join [1822_sales] Продажи on Товары.КодТовара = Продажи.КодТовара
left join [1822_sum_reval] Переоценка on Товары.КодТовара = Переоценка.КодТовара

where Товары.КодТовара &gt; 0</property>
                <property
                  dataType="System.Int32"
                  description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                  name="CommandTimeout">600</property>
                <property
                  dataType="System.Boolean"
                  description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="Имя таблицы базы данных-источника."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Укажите режим получения данных о внешних столбцах"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Загрузка фактов\Сбор данных.Connections[IDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                  connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                  description="Диспетчер управляемых соединений"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET]"
                  name="Вывод источника ADO NET">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Дата]"
                      dataType="dbDate"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[Дата]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Дата]"
                      name="Дата"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                      dataType="i8"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                      name="КодТовара"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Остаток]"
                      dataType="numeric"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[Остаток]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Остаток]"
                      name="Остаток"
                      precision="18"
                      scale="3"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Стоимость]"
                      dataType="numeric"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[Стоимость]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Стоимость]"
                      name="Стоимость"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ОборачиваемостьДней]"
                      dataType="numeric"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ОборачиваемостьДней]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ОборачиваемостьДней]"
                      name="ОборачиваемостьДней"
                      precision="18"
                      scale="3"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[СуммаПотерь]"
                      dataType="numeric"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[СуммаПотерь]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[СуммаПотерь]"
                      name="СуммаПотерь"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПотериПроц]"
                      dataType="numeric"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ПотериПроц]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПотериПроц]"
                      name="ПотериПроц"
                      precision="18"
                      scale="3"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПереоценкаРуб]"
                      dataType="numeric"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ПереоценкаРуб]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПереоценкаРуб]"
                      name="ПереоценкаРуб"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПереоценкаПроц]"
                      dataType="numeric"
                      errorOrTruncationOperation="Преобразование"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ПереоценкаПроц]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПереоценкаПроц]"
                      name="ПереоценкаПроц"
                      precision="18"
                      scale="3"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[Дата]"
                      dataType="dbDate"
                      name="Дата" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                      dataType="i8"
                      name="КодТовара" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[Остаток]"
                      dataType="numeric"
                      name="Остаток"
                      precision="18"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[Стоимость]"
                      dataType="numeric"
                      name="Стоимость"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ОборачиваемостьДней]"
                      dataType="numeric"
                      name="ОборачиваемостьДней"
                      precision="18"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[СуммаПотерь]"
                      dataType="numeric"
                      name="СуммаПотерь"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ПотериПроц]"
                      dataType="numeric"
                      name="ПотериПроц"
                      precision="18"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ПереоценкаРуб]"
                      dataType="numeric"
                      name="ПереоценкаРуб"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].ExternalColumns[ПереоценкаПроц]"
                      dataType="numeric"
                      name="ПереоценкаПроц"
                      precision="18"
                      scale="3" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET]"
                  isErrorOut="true"
                  name="Вывод ошибок источника ADO NET">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[Дата]"
                      dataType="dbDate"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[Дата]"
                      name="Дата" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                      dataType="i8"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                      name="КодТовара" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[Остаток]"
                      dataType="numeric"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[Остаток]"
                      name="Остаток"
                      precision="18"
                      scale="3" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[Стоимость]"
                      dataType="numeric"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[Стоимость]"
                      name="Стоимость"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ОборачиваемостьДней]"
                      dataType="numeric"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ОборачиваемостьДней]"
                      name="ОборачиваемостьДней"
                      precision="18"
                      scale="3" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[СуммаПотерь]"
                      dataType="numeric"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[СуммаПотерь]"
                      name="СуммаПотерь"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ПотериПроц]"
                      dataType="numeric"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ПотериПроц]"
                      name="ПотериПроц"
                      precision="18"
                      scale="3" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ПереоценкаРуб]"
                      dataType="numeric"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ПереоценкаРуб]"
                      name="ПереоценкаРуб"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ПереоценкаПроц]"
                      dataType="numeric"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ПереоценкаПроц]"
                      name="ПереоценкаПроц"
                      precision="18"
                      scale="3" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Загрузка фактов\Факт"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
              description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
              name="Факт"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="Имя таблицы в целевой базе данных."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_consolidated"</property>
                <property
                  dataType="System.Int32"
                  description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                  expressionType="Notify"
                  name="CommandTimeout">600</property>
                <property
                  dataType="System.Boolean"
                  description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Загрузка фактов\Факт.Connections[IDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                  connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                  description="Диспетчер управляемых соединений"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="Вход назначения ADO NET">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[Дата]"
                      cachedDataType="dbDate"
                      cachedName="Дата"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[Дата]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Дата]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[КодТовара]"
                      cachedDataType="i8"
                      cachedName="КодТовара"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[КодТовара]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[ОборачиваемостьДней]"
                      cachedDataType="numeric"
                      cachedName="ОборачиваемостьДней"
                      cachedPrecision="18"
                      cachedScale="3"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ОборачиваемостьДней]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ОборачиваемостьДней]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[ПотериПроц]"
                      cachedDataType="numeric"
                      cachedName="ПотериПроц"
                      cachedPrecision="18"
                      cachedScale="3"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПотериПроц]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПотериПроц]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[ПереоценкаРуб]"
                      cachedDataType="numeric"
                      cachedName="ПереоценкаРуб"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПереоценкаРуб]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПереоценкаРуб]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[ПереоценкаПроц]"
                      cachedDataType="numeric"
                      cachedName="ПереоценкаПроц"
                      cachedPrecision="18"
                      cachedScale="3"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПереоценкаПроц]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[ПереоценкаПроц]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[Остаток]"
                      cachedDataType="numeric"
                      cachedName="Остаток"
                      cachedPrecision="18"
                      cachedScale="3"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ОстатокШт]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Остаток]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[Стоимость]"
                      cachedDataType="numeric"
                      cachedName="Стоимость"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ОстатокРуб]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[Стоимость]" />
                    <inputColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].Columns[СуммаПотерь]"
                      cachedDataType="numeric"
                      cachedName="СуммаПотерь"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПотериРуб]"
                      lineageId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET].Columns[СуммаПотерь]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[Дата]"
                      dataType="dbTimeStamp"
                      name="Дата" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                      dataType="i8"
                      name="КодТовара" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ОстатокШт]"
                      dataType="numeric"
                      name="ОстатокШт"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ОстатокРуб]"
                      dataType="numeric"
                      name="ОстатокРуб"
                      precision="18"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ОборачиваемостьДней]"
                      dataType="numeric"
                      name="ОборачиваемостьДней"
                      precision="18"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПотериРуб]"
                      dataType="numeric"
                      name="ПотериРуб"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПотериПроц]"
                      dataType="numeric"
                      name="ПотериПроц"
                      precision="18"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПереоценкаРуб]"
                      dataType="numeric"
                      name="ПереоценкаРуб"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET].ExternalColumns[ПереоценкаПроц]"
                      dataType="numeric"
                      name="ПереоценкаПроц"
                      precision="18"
                      scale="3" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Загрузка фактов\Факт.Outputs[Вывод ошибок назначения ADO NET]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="Вывод ошибок назначения ADO NET"
                  synchronousInputId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Загрузка фактов\Факт.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Загрузка фактов\Факт.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Загрузка фактов\Факт.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Загрузка фактов\Факт.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Загрузка фактов.Paths[Вывод источника ADO NET]"
              endId="Package\Загрузка фактов\Факт.Inputs[Вход назначения ADO NET]"
              name="Вывод источника ADO NET"
              startId="Package\Загрузка фактов\Сбор данных.Outputs[Вывод источника ADO NET]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Подготовка данных"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Контейнер последовательности"
      DTS:DTSID="{8D8710B9-606D-4EB0-AF47-9AD3EA0DB46A}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Подготовка данных">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Подготовка данных\Остатки на основе среза из DWH"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{69B86A17-81A3-449F-893A-9910E3654D0B}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Остатки на основе среза из DWH">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{207BA294-4C27-41F9-A6C3-2FE407D24590}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка остатков из DWH"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="DWH"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT
	Остатки.Код,
	sum(Остатки.Остаток) Остаток
FROM (
	SELECT 
		Код_магазина as КодМагазина,
		дата as Дата, 
		Код_товара as Код, 
		Остатки.Код_склада_в_магазине as Склад, 
		Остаток as Остаток
	FROM [td].[f_Срез_остатков_на_дату](cast(dateadd(day, -1, getdate()) as date)) as Остатки
  ) as Остатки
where КодМагазина in (
		SELECT [Код]
		FROM [DWH].[dbo].[t_dim_Магазины]
		where Группа = 'Розница                                 '
			and Дата_открытия &lt; GETDATE()
			and (Дата_конца_реконструкции is null or Дата_конца_реконструкции &lt; GETDATE())
	)
group by Код</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.DWH]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.DWH]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Код]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Код]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Код]"
                              name="Код"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Остаток]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Остаток]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Остаток]"
                              name="Остаток"
                              precision="38"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Код]"
                              dataType="i8"
                              name="Код" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Остаток]"
                              dataType="numeric"
                              name="Остаток"
                              precision="38"
                              scale="3" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Код]"
                              dataType="i8"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Код]"
                              name="Код" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Остаток]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Остаток]"
                              name="Остаток"
                              precision="38"
                              scale="3" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="ERP_reports"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_balance"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].Columns[Остаток]"
                              cachedDataType="numeric"
                              cachedName="Остаток"
                              cachedPrecision="38"
                              cachedScale="3"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Остаток]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Остаток]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].Columns[Код]"
                              cachedDataType="i8"
                              cachedName="Код"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Код]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Остаток]"
                              dataType="numeric"
                              name="Остаток"
                              precision="18"
                              scale="3" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{3C103559-7606-441E-AB28-1CCCBBA1E167}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка средних остатков из DWH"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="DWH"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">DECLARE @StartDate DATE, @EndDate DATE, @Дата DATE
SET @StartDate = dateadd(day, -14, getdate())
SET @EndDate = dateadd(day, -1, getdate())
set @Дата = @StartDate

declare @buff_остатки_на_периуд table (
	Дата    date              not null,
	Код_магазина     int      not null,
	Код_склада_в_магазине int not null,
	Код_товара int            not null,
	Остаток numeric(18, 3)    not null
);

declare @tmp_1822_Остатки table (
	Дата    date           NOT NULL,
	Код     int            NOT NULL,
	Остаток numeric(18, 3) NOT NULL
);

while @Дата &lt;= @EndDate begin
	insert into
		@buff_остатки_на_периуд
	select 
		Дата, Код_магазина, Код_склада_в_магазине, Код_товара, Остаток
	from (
		select 
			@Дата Дата,
			Код_магазина,
			Код_склада_в_магазине,
			Код_товара, 
			sum(Остаток) Остаток
		from (
			select
				ib_f.Код_магазина,
				ib_f.Код_склада_в_магазине,
				ib_f.Код_товара,
				ib.Остаток
			from td.t_fact_Начальные_остатки ib
			right join (
				select
					max(ib_f.Дата) Дата,
					ib_f.Код_Товара,
					ib_f.Код_магазина,
					ib_f.Код_склада_в_магазине
				from
					td.t_fact_Начальные_остатки ib_f
				where
					ib_f.Дата = dateadd(day, -1, dateFromParts(year(@Дата), month(@Дата), 1))
				group by 
					ib_f.Код_товара, ib_f.Код_магазина, ib_f.Код_склада_в_магазине
				) ib_f on ib.Дата = ib_f.Дата and ib.Код_товара = ib_f.Код_товара and ib.Код_магазина = ib_f.Код_магазина and ib.Код_склада_в_магазине = ib_f.Код_склада_в_магазине
			) о
		left join dbo.t_dim_Магазины as Магазины on Магазины.Код = о.Код_магазина

		where Код_магазина in (
			SELECT [Код]
			FROM [DWH].[dbo].[t_dim_Магазины]
			where Группа = 'Розница                                 '
				and Дата_открытия &lt; GETDATE()
				and (Дата_конца_реконструкции is null or Дата_конца_реконструкции &lt; GETDATE())
		) and Код_магазина &gt; 0

		group by Код_магазина, Код_склада_в_магазине, Код_товара
	) о;
	set @Дата = dateAdd(day, 1, @Дата);
End

insert into @tmp_1822_Остатки
SELECT
	Остатки.Дата,
	Остатки.Код_товара as Код,
	sum(Остатки.Остаток) Остаток
FROM @buff_остатки_на_периуд as Остатки
group by Остатки.Дата, Остатки.Код_товара


Select
	К.Код,
	avg(о.остаток) as остаток
from (
	SELECT DATEADD(DAY,number,@StartDate) [Date]
	FROM master..spt_values
	WHERE type = 'P'
	AND DATEADD(DAY,number,@StartDate) &lt;= @EndDate
) calendar
cross join (select distinct Код from @tmp_1822_Остатки) к
left join @tmp_1822_Остатки о on Date = о.Дата and к.код = о.код
group by к.Код</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.DWH]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.DWH]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Код]"
                              dataType="i4"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Код]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Код]"
                              name="Код"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[остаток]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[остаток]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[остаток]"
                              name="остаток"
                              precision="38"
                              scale="6"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Код]"
                              dataType="i4"
                              name="Код" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[остаток]"
                              dataType="numeric"
                              name="остаток"
                              precision="38"
                              scale="6" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Код]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Код]"
                              name="Код" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[остаток]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[остаток]"
                              name="остаток"
                              precision="38"
                              scale="6" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="ERP_reports"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_avg_bal"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].Columns[остаток]"
                              cachedDataType="numeric"
                              cachedName="остаток"
                              cachedPrecision="38"
                              cachedScale="6"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Остаток]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[остаток]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].Columns[Код]"
                              cachedDataType="i4"
                              cachedName="Код"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Код]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Остаток]"
                              dataType="numeric"
                              name="Остаток"
                              precision="18"
                              scale="3" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Остатки на основе среза из DWH\Очистка таблицы остатков"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{6FFB0288-C8CD-476F-9272-7C27DB852884}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка таблицы остатков"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="5">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
                  SQLTask:SqlStatementSource="truncate table [1822_balance]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Остатки на основе среза из DWH\Очистка таблицы средний остаток"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{C6B6DDEB-5097-40FF-B997-C2C2618F9E98}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка таблицы средний остаток"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="6">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
                  SQLTask:SqlStatementSource="truncate table [1822_avg_bal]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Остатки на основе среза из DWH.PrecedenceConstraints[Ограничение 16]"
              DTS:CreationName=""
              DTS:DTSID="{7FA44DE5-C187-4A36-AA78-C971D854C78C}"
              DTS:From="Package\Подготовка данных\Остатки на основе среза из DWH\Очистка таблицы остатков"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 16"
              DTS:To="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Остатки на основе среза из DWH.PrecedenceConstraints[Ограничение 6]"
              DTS:CreationName=""
              DTS:DTSID="{D5375E54-B494-4F71-870C-80C8DC8F9455}"
              DTS:From="Package\Подготовка данных\Остатки на основе среза из DWH\Очистка таблицы средний остаток"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 6"
              DTS:To="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Подготовка данных\Остатки на основе товародвижения"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{8156514E-9DC7-4CAF-ADF7-FFD221143CAB}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Остатки на основе товародвижения">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{852BDAA0-3FA8-48D5-B86C-3EF52ACD5035}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка стоимости остатков из DWH"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="DWH"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">declare @curdate date,
		@startdate date,
		@enddate date,
		@prevDateMonth date,
		@period date;
declare @array_shop table (
	Код_магазина int
);

set @startdate = dateadd(day, -day(getdate()) + 1, cast(getdate() as date))
set @enddate = dateadd(day, -1, getdate());


insert into @array_shop
SELECT Код as Код_магазина
FROM DWH.dbo.t_dim_Магазины
where Группа = 'Розница                                 ' and
	  Дата_открытия &lt; GETDATE() and (Дата_конца_реконструкции is null or Дата_конца_реконструкции &lt; GETDATE())


select 
	Остатки.Код_товара as КодТовара,
	sum(Остатки.ОстатокРуб) as ОстатокРуб
from 
(
select 
	товародвиж.Код_магазина,
	товародвиж.Код_товара,
	(isnull((
		select 
			sum(товародвиж_1.Сумма) 
		from DWH.td.t_fact_Товародвижение as товародвиж_1
		where 
			товародвиж_1.Код_товара = товародвиж.Код_товара and
			товародвиж_1.Дата &gt; @startdate and 
			товародвиж_1.Дата &lt;= @enddate and
			товародвиж_1.Код_магазина = товародвиж.Код_магазина
	), 0) + isnull((
		select 
			top(1)
			нач_остаток.Сумма
		from DWH.td.t_fact_Начальные_остатки as нач_остаток 
		where 
			нач_остаток.Код_магазина = товародвиж.Код_магазина and 
			нач_остаток.Код_товара = товародвиж.Код_товара
		order by нач_остаток.Дата desc
	), 0)) as ОстатокРуб
from DWH.td.t_fact_Товародвижение as товародвиж
where
	товародвиж.Код_магазина in (select * from @array_shop) and 
	товародвиж.Дата &gt; @startdate and 
	товародвиж.Дата &lt;= @enddate
group by Код_магазина, Код_товара) as Остатки
group by Остатки.Код_товара</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.DWH]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.DWH]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                              name="КодТовара"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[ОстатокРуб]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[ОстатокРуб]"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[ОстатокРуб]"
                              name="ОстатокРуб"
                              precision="38"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[ОстатокРуб]"
                              dataType="numeric"
                              name="ОстатокРуб"
                              precision="38"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                              dataType="i8"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                              name="КодТовара" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ОстатокРуб]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ОстатокРуб]"
                              name="ОстатокРуб"
                              precision="38"
                              scale="2" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="s19-storage-sql"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_balance_value"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].Columns[КодТовара]"
                              cachedDataType="i8"
                              cachedName="КодТовара"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[КодТовара]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].Columns[ОстатокРуб]"
                              cachedDataType="numeric"
                              cachedName="ОстатокРуб"
                              cachedPrecision="38"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[Стоимость]"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[ОстатокРуб]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[Стоимость]"
                              dataType="numeric"
                              name="Стоимость"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Остатки на основе товародвижения\Очистка стоимости остатков"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{9965A50B-F651-4FE7-A26E-24F2D10E514A}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка стоимости остатков"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
                  SQLTask:TimeOut="600"
                  SQLTask:SqlStatementSource="truncate table [1822_balance_value]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Остатки на основе товародвижения.PrecedenceConstraints[Ограничение 1]"
              DTS:CreationName=""
              DTS:DTSID="{72C35190-A59C-480A-9855-21057CE5F9BD}"
              DTS:From="Package\Подготовка данных\Остатки на основе товародвижения\Очистка стоимости остатков"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 1"
              DTS:To="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Подготовка данных\Переоценка"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{D87E3B00-A041-4594-A5C7-7E0AE9D9F121}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Переоценка">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{670241BB-BB8F-4A92-AEC7-57CC37A0752A}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка суммы переоценки из ОТБРС"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="s19-stroage-sql"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_sum_reval"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET].Columns[КодТовара]"
                              cachedDataType="wstr"
                              cachedLength="10"
                              cachedName="КодТовара"
                              externalMetadataColumnId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].Columns[КодТовара]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET].Columns[СуммаПереоценки]"
                              cachedDataType="numeric"
                              cachedName="СуммаПереоценки"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[СуммаПереоценки]"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].Columns[СуммаПереоценки]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[СуммаПереоценки]"
                              dataType="numeric"
                              name="СуммаПереоценки"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="ОТБРС"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">declare @dateStart  char(8);
declare @dateEnd    char(9);
declare @curDate  datetime;

set @curDate = dateAdd(day, -1, getdate());
set @dateStart = CAST(DATEPART(YEAR, @curDate ) AS CHAR(4)) + RIGHT('0' + LTRIM(RTRIM(CAST(DATEPART(MONTH, @curDate ) AS CHAR(2)))), 2) + RIGHT('0' + LTRIM(RTRIM(CAST(DATEPART(DAY, @curDate ) AS CHAR(2)))), 2);
set @dateEnd   = CAST(DATEPART(YEAR, @curDate ) AS CHAR(4)) + RIGHT('0' + LTRIM(RTRIM(CAST(DATEPART(MONTH, @curDate ) AS CHAR(2)))), 2) + RIGHT('0' + LTRIM(RTRIM(CAST(DATEPART(DAY, @curDate ) AS CHAR(2)))), 2) + 'Z';

select
КодТовара,
cast(sum(СуммаРазницы) as numeric(18,2)) as СуммаПереоценки
from (
SELECT
    СпрТов.Code КодТовара,
    SUM(ДокС.sp5382 * -1) as СуммаРазницы
FROM
    dt5384 as ДокС
INNER JOIN
    dh5384 as Док ON Док.IDDoc = ДокС.IDDoc AND
                                  Док.sp5375 in ('    1B   ', '    1Q   ') AND
												Док.sp5389 in (select id from sc36 СпрКлиенты (nolock) where СпрКлиенты.parentid = '     1   ' and СпрКлиенты.SP2843 &lt; getdate() and (СпрКлиенты.SP4571 is null or СпрКлиенты.SP4571 &lt; getdate()))
INNER JOIN
    _1SJourn as Жур (nolock) ON Жур.IDDoc = ДокС.IDDoc And
                       Жур.Date_Time_IDDoc BETWEEN @dateStart AND @dateEnd AND
                       Жур.Closed &amp; 1 = 1
left join sc11 СпрТов (nolock) on ДокС.sp5378 = СпрТов.ID 
GROUP BY
    СпрТов.Code
union all
SELECT
    СпрТов.Code КодТовара,
    SUM(ДокС1.sp5872 * ДокС1.sp5864 * ДокС1.sp5862 / 100) as СуммаРазницы
FROM
    dt5866 as ДокС1
INNER JOIN
    dh5866 as Док1 ON Док1.IDDoc = ДокС1.IDDoc AND
												Док1.sp5858 in (select id from sc36 СпрКлиенты (nolock) where СпрКлиенты.parentid = '     1   ' and СпрКлиенты.SP2843 &lt; getdate() and (СпрКлиенты.SP4571 is null or СпрКлиенты.SP4571 &lt; getdate()))
INNER JOIN
    _1SJourn as Жур (nolock) ON Жур.IDDoc = ДокС1.IDDoc And
                       Жур.Date_Time_IDDoc BETWEEN @dateStart AND @dateEnd
left join sc11 СпрТов (nolock) on ДокС1.sp5859 = СпрТов.ID 
GROUP BY
    СпрТов.Code
) a
where КодТовара is not null
group by КодТовара</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[serv-term.rozn.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[serv-term.rozn.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                              dataType="wstr"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                              length="10"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                              name="КодТовара"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].Columns[СуммаПереоценки]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].ExternalColumns[СуммаПереоценки]"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].Columns[СуммаПереоценки]"
                              name="СуммаПереоценки"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                              dataType="wstr"
                              length="10"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET].ExternalColumns[СуммаПереоценки]"
                              dataType="numeric"
                              name="СуммаПереоценки"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                              dataType="wstr"
                              length="10"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                              name="КодТовара" />
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[СуммаПереоценки]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[СуммаПереоценки]"
                              name="СуммаПереоценки"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Переоценка\Очистка суммы переоценки"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{BAE20D3E-70E1-40DA-8F60-55CF6015775F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка суммы переоценки"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
                  SQLTask:TimeOut="600"
                  SQLTask:SqlStatementSource="truncate table [1822_sum_reval]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Переоценка.PrecedenceConstraints[Ограничение 3]"
              DTS:CreationName=""
              DTS:DTSID="{486553EA-0019-47C4-AAE9-2F4C283CEA07}"
              DTS:From="Package\Подготовка данных\Переоценка\Очистка суммы переоценки"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 3"
              DTS:To="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Подготовка данных\Потери"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{64A29EE7-C82D-4682-8F23-752D47850441}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Потери">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{5A51E123-2DB2-479F-A9E9-B04EEBC1F0C0}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка суммы потерь из DWH"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="DWH"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">declare @curdate date;
set @curdate = dateadd(day, -1, getdate());


SELECT 
	Товародвижение.Код_товара as КодТовара,
	sum(Товародвижение.Сумма * -1) as Сумма
FROM DWH.td.t_fact_Товародвижение as Товародвижение
where 
	Товародвижение.Дата = @curdate and 
	Товародвижение.Код_причины in (19, 17, 42, 70, 175, 39, 10, 21, 143, 26, 12, 32, 13, 9, 81) and 
	Товародвижение.Код_магазина in (
		SELECT Код
		FROM DWH.dbo.t_dim_Магазины
		where Группа = 'Розница                                 '
			and Дата_открытия &lt; GETDATE()
			and (Дата_конца_реконструкции is null or Дата_конца_реконструкции &lt; GETDATE())
	)
group by Товародвижение.Код_товара
order by Товародвижение.Код_товара</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.DWH]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.DWH]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                              name="КодТовара"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Сумма]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Сумма]"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Сумма]"
                              name="Сумма"
                              precision="38"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Сумма]"
                              dataType="numeric"
                              name="Сумма"
                              precision="38"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                              dataType="i8"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                              name="КодТовара" />
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Сумма]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Сумма]"
                              name="Сумма"
                              precision="38"
                              scale="2" />
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="s19-storage-sql"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_sum_loses"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].Columns[КодТовара]"
                              cachedDataType="i8"
                              cachedName="КодТовара"
                              externalMetadataColumnId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[КодТовара]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].Columns[Сумма]"
                              cachedDataType="numeric"
                              cachedName="Сумма"
                              cachedPrecision="38"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[СуммаПотерь]"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET].Columns[Сумма]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET].ExternalColumns[СуммаПотерь]"
                              dataType="numeric"
                              name="СуммаПотерь"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Потери\Очистка суммы потерь"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{B8BBD0CF-A8AA-44FA-886C-65D333A357B5}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка суммы потерь"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
                  SQLTask:TimeOut="600"
                  SQLTask:SqlStatementSource="Truncate table [1822_sum_loses]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Потери.PrecedenceConstraints[Ограничение 2]"
              DTS:CreationName=""
              DTS:DTSID="{220292BC-1AB1-41C4-A052-60331A0B20A3}"
              DTS:From="Package\Подготовка данных\Потери\Очистка суммы потерь"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 2"
              DTS:To="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Подготовка данных\Продажи из DWH"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{86574A35-CE34-4B9D-8E4D-06F36C1669C7}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Продажи из DWH">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{513777F0-37D3-47F7-924F-7AE996C2BC77}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка дневных продаж"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="DWH"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 
	Продажи.Код_товара as GOODS_ID,
	sum(Продажи.Итоговая_сумма_после_применения_скидок) as Продажи
FROM [DWH].[cass].[t_fact_Детализация_чеков] as Продажи
left join [DWH].[cass].[t_dim_Кассы] as Кассы on Кассы.Код_кассы = Продажи.Код_кассы
where 
	Продажи.Дата_добавления_позиции between cast(DATEADD(DAY, -1, GETDATE()) AS date) and CAST(GETDATE() as date) and 
	Кассы.Код_магазина in (
		SELECT [Код]
		FROM [DWH].[dbo].[t_dim_Магазины]
		where Группа = 'Розница                                 '
			and Дата_открытия &lt; GETDATE()
			and (Дата_конца_реконструкции is null or Дата_конца_реконструкции &lt; GETDATE())
	)
group by Продажи.Код_товара</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.DWH]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.DWH]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].Columns[GOODS_ID]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[GOODS_ID]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].Columns[GOODS_ID]"
                              name="GOODS_ID"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].Columns[Продажи]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Продажи]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].Columns[Продажи]"
                              name="Продажи"
                              precision="38"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[GOODS_ID]"
                              dataType="i8"
                              name="GOODS_ID" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Продажи]"
                              dataType="numeric"
                              name="Продажи"
                              precision="38"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[GOODS_ID]"
                              dataType="i8"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[GOODS_ID]"
                              name="GOODS_ID" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Продажи]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Продажи]"
                              name="Продажи"
                              precision="38"
                              scale="2" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="ERP_reports"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_sales"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET].Columns[Продажи]"
                              cachedDataType="numeric"
                              cachedName="Продажи"
                              cachedPrecision="38"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Продажи]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].Columns[Продажи]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET].Columns[GOODS_ID]"
                              cachedDataType="i8"
                              cachedName="GOODS_ID"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET].Columns[GOODS_ID]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Продажи]"
                              dataType="numeric"
                              name="Продажи"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{6F859B2F-594C-4EC0-AC39-3BEC36E14AE9}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка продаж за 14 дней для расчета средних"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="DWH"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">DECLARE @StartDate DATE, @EndDate DATE
SET @StartDate = dateadd(day, -14, getdate())
SET @EndDate = GETDATE()
SELECT 
	Продажи.Дата_добавления_позиции as Дата,
	Продажи.Код_товара as GOODS_ID,
	sum(Продажи.Количество) as Продажи
FROM [DWH].[cass].[t_fact_Детализация_чеков] as Продажи
left join [DWH].[cass].[t_dim_Кассы] as Кассы on Кассы.Код_кассы = Продажи.Код_кассы
where 
	Продажи.Дата_добавления_позиции between @StartDate and @EndDate and 
	Кассы.Код_магазина in (
		SELECT [Код]
		FROM [DWH].[dbo].[t_dim_Магазины]
		where Группа = 'Розница                                 '
			and Дата_открытия &lt; GETDATE()
			and (Дата_конца_реконструкции is null or Дата_конца_реконструкции &lt; GETDATE())
	)
group by Продажи.Дата_добавления_позиции, Продажи.Код_товара</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.DWH]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.DWH]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[Дата]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Дата]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[Дата]"
                              name="Дата"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[GOODS_ID]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[GOODS_ID]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[GOODS_ID]"
                              name="GOODS_ID"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[Продажи]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Продажи]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[Продажи]"
                              name="Продажи"
                              precision="38"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Дата]"
                              dataType="dbDate"
                              name="Дата" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[GOODS_ID]"
                              dataType="i8"
                              name="GOODS_ID" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].ExternalColumns[Продажи]"
                              dataType="numeric"
                              name="Продажи"
                              precision="38"
                              scale="3" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Дата]"
                              dataType="dbDate"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Дата]"
                              name="Дата" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[GOODS_ID]"
                              dataType="i8"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[GOODS_ID]"
                              name="GOODS_ID" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Продажи]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[Продажи]"
                              name="Продажи"
                              precision="38"
                              scale="3" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="ERP_reports"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_tmp_sales"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].Columns[Продажи]"
                              cachedDataType="numeric"
                              cachedName="Продажи"
                              cachedPrecision="38"
                              cachedScale="3"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Продажи]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[Продажи]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].Columns[GOODS_ID]"
                              cachedDataType="i8"
                              cachedName="GOODS_ID"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТоварв]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[GOODS_ID]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].Columns[Дата]"
                              cachedDataType="dbDate"
                              cachedName="Дата"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Дата]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET].Columns[Дата]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Дата]"
                              dataType="dbTimeStamp"
                              name="Дата" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[КодТоварв]"
                              dataType="i8"
                              name="КодТоварв" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET].ExternalColumns[Продажи]"
                              dataType="numeric"
                              name="Продажи"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{29FABBCC-426B-48AC-9D78-0FA5135D5FC7}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Определение средних продаж за 14 дней"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                      description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                      name="Временная таблица"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">DECLARE @StartDate DATE, @EndDate DATE
SET @StartDate = dateadd(day, -14, getdate())
SET @EndDate = dateadd(day, -1, getdate())
Select К.КодТоварв, avg(case when о.Продажи is null then 0 else о.Продажи end) Продажи from (
SELECT DATEADD(DAY,number,@StartDate) [Date]
FROM master..spt_values
WHERE type = 'P'
AND DATEADD(DAY,number,@StartDate) &lt;= @EndDate) calendar
cross join (select distinct КодТоварв from [dbo].[1822_tmp_sales]) к
left join [dbo].[1822_tmp_sales] о on Date = о.Дата and к.КодТоварв = о.КодТоварв
group by к.КодТоварв
order by КодТоварв</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="Имя таблицы базы данных-источника."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Укажите режим получения данных о внешних столбцах"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET]"
                          name="Вывод источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].Columns[КодТоварв]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].ExternalColumns[КодТоварв]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].Columns[КодТоварв]"
                              name="КодТоварв"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].Columns[Продажи]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].ExternalColumns[Продажи]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].Columns[Продажи]"
                              name="Продажи"
                              precision="38"
                              scale="6"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].ExternalColumns[КодТоварв]"
                              dataType="i8"
                              name="КодТоварв" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].ExternalColumns[Продажи]"
                              dataType="numeric"
                              name="Продажи"
                              precision="38"
                              scale="6" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET]"
                          isErrorOut="true"
                          name="Вывод ошибок источника ADO NET">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[КодТоварв]"
                              dataType="i8"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[КодТоварв]"
                              name="КодТоварв" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[Продажи]"
                              dataType="numeric"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[Продажи]"
                              name="Продажи"
                              precision="38"
                              scale="6" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                      description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                      name="Средние продажи"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Имя таблицы в целевой базе данных."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."1822_avg_sales"</property>
                        <property
                          dataType="System.Int32"
                          description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                          expressionType="Notify"
                          name="CommandTimeout">600</property>
                        <property
                          dataType="System.Boolean"
                          description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          connectionManagerRefId="Package.ConnectionManagers[S19-STORAGE-SQL.ERP_reports.reader]"
                          description="Диспетчер управляемых соединений"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="Вход назначения ADO NET">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET].Columns[Продажи]"
                              cachedDataType="numeric"
                              cachedName="Продажи"
                              cachedPrecision="38"
                              cachedScale="6"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET].ExternalColumns[Продажи]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].Columns[Продажи]" />
                            <inputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET].Columns[КодТоварв]"
                              cachedDataType="i8"
                              cachedName="КодТоварв"
                              externalMetadataColumnId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET].Columns[КодТоварв]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET].ExternalColumns[Продажи]"
                              dataType="numeric"
                              name="Продажи"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Outputs[Вывод ошибок назначения ADO NET]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Вывод ошибок назначения ADO NET"
                          synchronousInputId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней.Paths[Вывод источника ADO NET]"
                      endId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи.Inputs[Вход назначения ADO NET]"
                      name="Вывод источника ADO NET"
                      startId="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица.Outputs[Вывод источника ADO NET]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Продажи из DWH\Очистка таблицы продаж"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{5B011643-596F-4D6C-8245-2535646A78EE}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка таблицы продаж"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="4">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
                  SQLTask:TimeOut="600"
                  SQLTask:SqlStatementSource="truncate table [1822_sales]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Подготовка данных\Продажи из DWH\Очистка таблицы средних продаж"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{CAA4235E-C860-4376-9FFF-1AA917C86925}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка таблицы средних продаж"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="3">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
                  SQLTask:TimeOut="600"
                  SQLTask:SqlStatementSource="truncate table [1822_avg_sales]&#xA;truncate table [1822_tmp_sales]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Продажи из DWH.PrecedenceConstraints[Ограничение 11]"
              DTS:CreationName=""
              DTS:DTSID="{8166A694-0298-4F06-9E73-56EFC6FF1AF3}"
              DTS:From="Package\Подготовка данных\Продажи из DWH\Очистка таблицы продаж"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 11"
              DTS:To="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Продажи из DWH.PrecedenceConstraints[Ограничение 13]"
              DTS:CreationName=""
              DTS:DTSID="{CAFCE4C3-4515-400F-9876-BA91D5F30180}"
              DTS:From="Package\Подготовка данных\Продажи из DWH\Очистка таблицы средних продаж"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 13"
              DTS:To="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Подготовка данных\Продажи из DWH.PrecedenceConstraints[Ограничение 14]"
              DTS:CreationName=""
              DTS:DTSID="{B5A94A61-E89C-49B3-9743-52F622BFD958}"
              DTS:From="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 14"
              DTS:To="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Удаление фактов за предыдущий день"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Задача &quot;Выполнение SQL&quot;"
      DTS:DTSID="{60D2C12E-7F37-48D2-AF22-CC350A40DF30}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Удаление фактов за предыдущий день"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{2C1A025F-A61D-4728-B1C1-109CB1C5EB9E}"
          SQLTask:TimeOut="600"
          SQLTask:SqlStatementSource="delete from [1822_consolidated] where Дата = cast(dateadd(day, -1, getdate()) as date)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение]"
      DTS:CreationName=""
      DTS:DTSID="{9C6B55A8-F34F-46C6-A527-A297549D6469}"
      DTS:From="Package\Подготовка данных"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение"
      DTS:To="Package\Удаление фактов за предыдущий день" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 17]"
      DTS:CreationName=""
      DTS:DTSID="{ABC966B8-9DAF-47D0-8999-404927A3DD7D}"
      DTS:From="Package\Удаление фактов за предыдущий день"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 17"
      DTS:To="Package\Загрузка фактов" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="336,58"
          Id="Package\Загрузка фактов"
          TopLeft="810.511904761903,1554.13095238095" />
        <NodeLayout
          Size="210,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH"
          TopLeft="9.96031746031758,150.293650793651" />
        <NodeLayout
          Size="253,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH"
          TopLeft="242.420634920635,151.007936507937" />
        <NodeLayout
          Size="211,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Очистка таблицы остатков"
          TopLeft="9.07142857142856,3.78571428571422" />
        <NodeLayout
          Size="249,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Очистка таблицы средний остаток"
          TopLeft="235.309523809524,4.81746031746025" />
        <EdgeLayout
          Id="Package\Подготовка данных\Остатки на основе среза из DWH.PrecedenceConstraints[Ограничение 16]"
          TopLeft="114.765873015873,45.7857142857142">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,104.507936507937"
              Start="0,0"
              End="0,97.0079365079366">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,97.0079365079366" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Подготовка данных\Остатки на основе среза из DWH.PrecedenceConstraints[Ограничение 6]"
          TopLeft="359.809523809524,46.8174603174602">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="9.11111111111103,104.190476190477"
              Start="0,0"
              End="9.11111111111103,96.6904761904767">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,48.0952380952384" />
                  <mssgle:CubicBezierSegment
                    Point1="0,48.0952380952384"
                    Point2="0,52.0952380952384"
                    Point3="4,52.0952380952384" />
                  <mssgle:LineSegment
                    End="5.11111111111103,52.0952380952384" />
                  <mssgle:CubicBezierSegment
                    Point1="5.11111111111103,52.0952380952384"
                    Point2="9.11111111111103,52.0952380952384"
                    Point3="9.11111111111103,56.0952380952384" />
                  <mssgle:LineSegment
                    End="9.11111111111103,96.6904761904767" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="503,206"
          Size="503,249"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH"
          TopLeft="12.5714285714284,15.7142857142857" />
        <NodeLayout
          Size="263,42"
          Id="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH"
          TopLeft="7.72222222222229,115.436507936508" />
        <NodeLayout
          Size="219,42"
          Id="Package\Подготовка данных\Остатки на основе товародвижения\Очистка стоимости остатков"
          TopLeft="17.6428571428567,13.3412698412699" />
        <EdgeLayout
          Id="Package\Подготовка данных\Остатки на основе товародвижения.PrecedenceConstraints[Ограничение 1]"
          TopLeft="127.142857142857,55.3412698412699">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="12.0793650793656,60.0952380952384"
              Start="0,0"
              End="12.0793650793656,52.5952380952384">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.0476190476192" />
                  <mssgle:CubicBezierSegment
                    Point1="0,26.0476190476192"
                    Point2="0,30.0476190476192"
                    Point3="4,30.0476190476192" />
                  <mssgle:LineSegment
                    End="8.07936507936563,30.0476190476192" />
                  <mssgle:CubicBezierSegment
                    Point1="8.07936507936563,30.0476190476192"
                    Point2="12.0793650793656,30.0476190476192"
                    Point3="12.0793650793656,34.0476190476192" />
                  <mssgle:LineSegment
                    End="12.0793650793656,52.5952380952384" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="279,174"
          Size="279,217"
          Id="Package\Подготовка данных\Остатки на основе товародвижения"
          TopLeft="370.555555555556,298.888888888889" />
        <NodeLayout
          Size="268,42"
          Id="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС"
          TopLeft="12.4841269841294,78.547619047619" />
        <NodeLayout
          Size="215,42"
          Id="Package\Подготовка данных\Переоценка\Очистка суммы переоценки"
          TopLeft="37.0555555555584,7.30952380952385" />
        <EdgeLayout
          Id="Package\Подготовка данных\Переоценка.PrecedenceConstraints[Ограничение 3]"
          TopLeft="145.519841269844,49.3095238095239">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29.2380952380951"
              Start="0,0"
              End="0,21.7380952380951">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.7380952380951" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="325,176"
          Size="325,219"
          Id="Package\Подготовка данных\Переоценка"
          TopLeft="16.4920634920588,297.019841269842" />
        <NodeLayout
          Size="235,42"
          Id="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH"
          TopLeft="5.5,85.9920634920636" />
        <NodeLayout
          Size="191,42"
          Id="Package\Подготовка данных\Потери\Очистка суммы потерь"
          TopLeft="29.5,2.84920634920644" />
        <EdgeLayout
          Id="Package\Подготовка данных\Потери.PrecedenceConstraints[Ограничение 2]"
          TopLeft="124,44.8492063492063">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,41.1428571428571"
              Start="0,0"
              End="0,33.6428571428571">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33.6428571428571" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="246,173"
          Size="246,216"
          Id="Package\Подготовка данных\Потери"
          TopLeft="691.666666666667,297.777777777778" />
        <NodeLayout
          Size="207,42"
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж"
          TopLeft="330,143" />
        <NodeLayout
          Size="323,42"
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних"
          TopLeft="5.5,76.7698412698413" />
        <NodeLayout
          Size="284,42"
          Id="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней"
          TopLeft="21.6071428571427,145.857142857143" />
        <NodeLayout
          Size="205,42"
          Id="Package\Подготовка данных\Продажи из DWH\Очистка таблицы продаж"
          TopLeft="327.5,6" />
        <NodeLayout
          Size="248,42"
          Id="Package\Подготовка данных\Продажи из DWH\Очистка таблицы средних продаж"
          TopLeft="49.7857142857142,6.92857142857142" />
        <EdgeLayout
          Id="Package\Подготовка данных\Продажи из DWH.PrecedenceConstraints[Ограничение 11]"
          TopLeft="431.75,48">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,95"
              Start="0,0"
              End="0,87.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,87.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Подготовка данных\Продажи из DWH.PrecedenceConstraints[Ограничение 13]"
          TopLeft="170.392857142857,48.9285714285714">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27.8412698412699"
              Start="0,0"
              End="0,20.3412698412699">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,20.3412698412699" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Подготовка данных\Продажи из DWH.PrecedenceConstraints[Ограничение 14]"
          TopLeft="165.303571428571,118.769841269841">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27.0873015873016"
              Start="0,0"
              End="0,19.5873015873016">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5873015873016" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="542,203"
          Size="542,246"
          Id="Package\Подготовка данных\Продажи из DWH"
          TopLeft="539.714285714286,20" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1141,571"
          Size="1141,614"
          Id="Package\Подготовка данных"
          TopLeft="403.837301587301,810.833333333333" />
        <NodeLayout
          Size="1116,42"
          Id="Package\Удаление фактов за предыдущий день"
          TopLeft="412.575396825401,1464.69841269841" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение]"
          TopLeft="972.456349206351,1407.83333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,56.8650793650802"
              Start="0,0"
              End="0,49.3650793650802">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,49.3650793650802" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 17]"
          TopLeft="974.543650793652,1506.69841269841">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,47.4325396825398"
              Start="0,0"
              End="0,39.9325396825398">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,39.9325396825398" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Загрузка фактов">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="103,42"
          Id="Package\Загрузка фактов\Факт"
          TopLeft="120,268" />
        <NodeLayout
          Size="143,42"
          Id="Package\Загрузка фактов\Сбор данных"
          TopLeft="98,90" />
        <EdgeLayout
          Id="Package\Загрузка фактов.Paths[Вывод источника ADO NET]"
          TopLeft="170.5,132">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,136"
              Start="0,0"
              End="0,128.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,128.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <TaskHost
    design-time-name="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="137,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\ERP_reports"
          TopLeft="160,229" />
        <NodeLayout
          Size="103,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH"
          TopLeft="126,110" />
        <EdgeLayout
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH.Paths[Вывод источника ADO NET]"
          TopLeft="177.5,152">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="51,77"
              Start="0,0"
              End="51,69.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,34.5"
                    Point2="0,38.5"
                    Point3="4,38.5" />
                  <mssgle:LineSegment
                    End="47,38.5" />
                  <mssgle:CubicBezierSegment
                    Point1="47,38.5"
                    Point2="51,38.5"
                    Point3="51,42.5" />
                  <mssgle:LineSegment
                    End="51,69.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка остатков из DWH\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="137,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\ERP_reports"
          TopLeft="107,160" />
        <NodeLayout
          Size="103,42"
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH"
          TopLeft="79,45" />
        <EdgeLayout
          Id="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH.Paths[Вывод источника ADO NET]"
          TopLeft="130.5,87">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="45,73"
              Start="0,0"
              End="45,65.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,32.5"
                    Point2="0,36.5"
                    Point3="4,36.5" />
                  <mssgle:LineSegment
                    End="41,36.5" />
                  <mssgle:CubicBezierSegment
                    Point1="41,36.5"
                    Point2="45,36.5"
                    Point3="45,40.5" />
                  <mssgle:LineSegment
                    End="45,65.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Подготовка данных\Остатки на основе среза из DWH\Загрузка средних остатков из DWH\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="151,42"
          Id="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\s19-storage-sql"
          TopLeft="72,166" />
        <NodeLayout
          Size="103,42"
          Id="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH"
          TopLeft="88,53" />
        <EdgeLayout
          Id="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH.Paths[Вывод источника ADO NET]"
          TopLeft="139.5,95">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8,71"
              Start="0,0"
              End="8,63.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31.5"
                    Point2="0,35.5"
                    Point3="4,35.5" />
                  <mssgle:LineSegment
                    End="4,35.5" />
                  <mssgle:CubicBezierSegment
                    Point1="4,35.5"
                    Point2="8,35.5"
                    Point3="8,39.5" />
                  <mssgle:LineSegment
                    End="8,63.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Подготовка данных\Остатки на основе товародвижения\Загрузка стоимости остатков из DWH\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="111,42"
          Id="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС"
          TopLeft="114,82" />
        <NodeLayout
          Size="151,42"
          Id="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\s19-stroage-sql"
          TopLeft="114,175" />
        <EdgeLayout
          Id="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС.Paths[Вывод источника ADO NET]"
          TopLeft="169.5,124">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="20,51"
              Start="0,0"
              End="20,43.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,21.5"
                    Point2="0,25.5"
                    Point3="4,25.5" />
                  <mssgle:LineSegment
                    End="16,25.5" />
                  <mssgle:CubicBezierSegment
                    Point1="16,25.5"
                    Point2="20,25.5"
                    Point3="20,29.5" />
                  <mssgle:LineSegment
                    End="20,43.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Подготовка данных\Переоценка\Загрузка суммы переоценки из ОТБРС\ОТБРС">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="151,42"
          Id="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\s19-storage-sql"
          TopLeft="126,188" />
        <NodeLayout
          Size="103,42"
          Id="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH"
          TopLeft="84,64" />
        <EdgeLayout
          Id="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH.Paths[Вывод источника ADO NET]"
          TopLeft="135.5,106">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="66,82"
              Start="0,0"
              End="66,74.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,37" />
                  <mssgle:CubicBezierSegment
                    Point1="0,37"
                    Point2="0,41"
                    Point3="4,41" />
                  <mssgle:LineSegment
                    End="62,41" />
                  <mssgle:CubicBezierSegment
                    Point1="62,41"
                    Point2="66,41"
                    Point3="66,45" />
                  <mssgle:LineSegment
                    End="66,74.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Подготовка данных\Потери\Загрузка суммы потерь из DWH\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="137,42"
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\ERP_reports"
          TopLeft="142,225" />
        <NodeLayout
          Size="103,42"
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH"
          TopLeft="90,101" />
        <EdgeLayout
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж.Paths[Вывод источника ADO NET]"
          TopLeft="141.5,143">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="69,82"
              Start="0,0"
              End="69,74.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,37" />
                  <mssgle:CubicBezierSegment
                    Point1="0,37"
                    Point2="0,41"
                    Point3="4,41" />
                  <mssgle:LineSegment
                    End="65,41" />
                  <mssgle:CubicBezierSegment
                    Point1="65,41"
                    Point2="69,41"
                    Point3="69,45" />
                  <mssgle:LineSegment
                    End="69,74.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Подготовка данных\Продажи из DWH\Загрузка дневных продаж\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="137,42"
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\ERP_reports"
          TopLeft="240,325" />
        <NodeLayout
          Size="103,42"
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH"
          TopLeft="156,144" />
        <EdgeLayout
          Id="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних.Paths[Вывод источника ADO NET]"
          TopLeft="207.5,186">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="101,139"
              Start="0,0"
              End="101,131.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,65.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,65.5"
                    Point2="0,69.5"
                    Point3="4,69.5" />
                  <mssgle:LineSegment
                    End="97,69.5" />
                  <mssgle:CubicBezierSegment
                    Point1="97,69.5"
                    Point2="101,69.5"
                    Point3="101,73.5" />
                  <mssgle:LineSegment
                    End="101,131.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Подготовка данных\Продажи из DWH\Загрузка продаж за 14 дней для расчета средних\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="167,42"
          Id="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Средние продажи"
          TopLeft="107,192" />
        <NodeLayout
          Size="176,42"
          Id="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней\Временная таблица"
          TopLeft="106,91" />
        <EdgeLayout
          Id="Package\Подготовка данных\Продажи из DWH\Определение средних продаж за 14 дней.Paths[Вывод источника ADO NET]"
          TopLeft="192.25,133">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,59"
              Start="0,0"
              End="0,51.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,51.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>
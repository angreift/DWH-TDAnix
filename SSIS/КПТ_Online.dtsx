<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="5/16/2022 8:20:00 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="S8-OLAP-TEST"
  DTS:CreatorName="TDANIX\kma1860"
  DTS:DTSID="{E7212DAA-2F8B-4354-8146-93937CF5223E}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5270.0"
  DTS:LocaleID="1049"
  DTS:ObjectName="КПТ Утренний"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="142"
  DTS:VersionGUID="{375768D4-2294-4601-8093-49789C9F6550}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[RSC]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{A9C97791-FC15-4696-B4C1-EE6329DDB253}"
      DTS:ObjectName="RSC">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=S12-1C-RSC;Initial Catalog=RSC;Provider=SQLOLEDB.1;Integrated Security=SSPI;Application Name=SSIS-KTP-{A8A37771-7EAD-4A9A-B00E-A72D7DE99C5F}RSC;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[s19-bi-db.KPT_prod]"
      DTS:CreationName="MSOLAP100"
      DTS:DTSID="{064BB1EF-2D50-4086-A0FB-FEF38E615703}"
      DTS:ObjectName="s19-bi-db.KPT_prod">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="0"
          DTS:ConnectRetryInterval="0"
          DTS:ConnectionString="Data Source=s19-bi-db;Initial Catalog=KPT_prod;Provider=MSOLAP.8;Encrypt Password=True;Integrated Security=SSPI;Mask Password=True;Persist Encrypted=True;Impersonation Level=Impersonate;Connect Timeout=300;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[s19-olap.DWH]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{D60F8A75-D388-44E8-AF68-64BA091C78D0}"
      DTS:ObjectName="s19-olap.DWH">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=s19-olap;Initial Catalog=DWH;Integrated Security=True;Application Name=SSIS-КПТ Утренний-{D60F8A75-D388-44E8-AF68-64BA091C78D0}s19-olap.DWH;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[s19-olap.KPT.reader]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{0A9C0910-30E2-4287-9B51-ABD08498C0E8}"
      DTS:ObjectName="s19-olap.KPT.reader">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=s19-olap;Initial Catalog=KPT;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;Application Name=SSIS-Package-{0A9C0910-30E2-4287-9B51-ABD08498C0E8}s8-olap-test.KPT.reader;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
      DTS:ObjectName="s19-olap.KPT.reader ADO .net">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=s19-olap;Initial Catalog=KPT;Integrated Security=True;Connect Timeout=1200;Application Name=&quot;SSIS-КПТ по причинам-{CD278E12-79DA-401D-8D60-C39A84DA3CBE}s8-olap-test.KPT.reader1&quot;;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[s19-olap.olap-rozn.reader ADO .net]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{3CCC8698-BFDB-4F23-9099-4A833F3C54CE}"
      DTS:ObjectName="s19-olap.olap-rozn.reader ADO .net">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=s19-olap;Initial Catalog=olap-rozn;Integrated Security=True;Connect Timeout=1200;Application Name=&quot;SSIS-КПТ по причинам-{3CCC8698-BFDB-4F23-9099-4A833F3C54CE}s8-olap-test.olap-rozn.reader&quot;;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[S19-RDSAPP-RSC.rsc.rsc-sql-reader ADO .net]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{FBEB8234-1760-4B95-B372-6387B08779D3}"
      DTS:ObjectName="S19-RDSAPP-RSC.rsc.rsc-sql-reader ADO .net">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=S19-RDSAPP-RSC;Initial Catalog=rsc;Integrated Security=True;Connect Timeout=1200;Application Name=&quot;SSIS-КПТ по причинам-{FBEB8234-1760-4B95-B372-6387B08779D3}S19-RDSAPP-RSC.rsc.rsc-sql-reader&quot;;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[S19-STORAGE-SQL.CS.reader]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{FE96603E-068F-4162-848F-C7345A53BD05}"
      DTS:ObjectName="S19-STORAGE-SQL.CS.reader">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=S19-STORAGE-SQL;Initial Catalog=CS;Integrated Security=True;Application Name=&quot;SSIS-КПТ Утренний-{FE96603E-068F-4162-848F-C7345A53BD05}S19-STORAGE-SQL.CS.reader&quot;;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{DA278520-B5EE-4235-B0F1-01C12DF79A14}"
      DTS:ObjectName="serv-term.rozn.reader ADO .net">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=serv-term;Initial Catalog=rozn;Integrated Security=True;Asynchronous Processing=True;Connect Timeout=0;Application Name=&quot;SSIS-КПТ по причинам-{DA278520-B5EE-4235-B0F1-01C12DF79A14}serv-term.rozn.reader1&quot;;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">18,7,OnError,19,OnExecStatusChanged,13,OnInformation,25,OnPipelinePostEndOfRowset,25,OnPipelinePostPrimeOutput,24,OnPipelinePreEndOfRowset,24,OnPipelinePrePrimeOutput,18,OnPipelineRowsSent,13,OnPostExecute,14,OnPostValidate,12,OnPreExecute,13,OnPreValidate,10,OnProgress,13,OnQueryCancel,12,OnTaskFailed,22,OnVariableValueChanged,9,OnWarning,10,Diagnostic</DTS:Property>
    <DTS:Property
      DTS:EventName="Diagnostic"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnExecStatusChanged"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnInformation"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPipelinePostEndOfRowset"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPipelinePostPrimeOutput"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPipelinePreEndOfRowset"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPipelinePrePrimeOutput"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPipelineRowsSent"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPostExecute"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPostValidate"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPreExecute"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnPreValidate"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnProgress"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnQueryCancel"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnTaskFailed"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnVariableValueChanged"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:Property
      DTS:EventName="OnWarning"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\КПТ"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Контейнер последовательности"
      DTS:DTSID="{99E41C93-919A-4A81-B669-4D7E2606EC50}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="КПТ">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\КПТ\DWH Продажи"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{F54126FD-B20A-4B6F-BFB2-B27443785950}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="DWH Продажи">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\КПТ\DWH Продажи\Очистка таблиц"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{B678EAE4-36D4-4F89-B0EA-362EFF0720B8}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Очистка таблиц"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:LoggingOptions
                DTS:FilterKind="0" />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                  SQLTask:TimeOut="30"
                  SQLTask:SqlStatementSource="&#xA;truncate table t_fact_Продажи_по_часам;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Data Flow Task"
              DTS:DTSID="{B35C876E-7089-45B2-8660-DB6CE440AF3C}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Продажи OLAP (ОТБОР ПО ДАТЕ)"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:LoggingOptions
                DTS:FilterKind="0" />
              <DTS:ObjectData>
                <pipeline
                  BLOBTempStoragePath=""
                  bufferTempStoragePath=""
                  version="1">
                  <components>
                    <component
                      refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Extracts data from a relational database by using a .NET provider."
                      name="DWH"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">set datefirst 7

declare @date as datetime
declare @dateN as datetime
declare @curdate as datetime

set @curdate=convert(varchar(16), dateadd(day, -1, getdate()), 112)

set @date =CASE 
WHEN DATEPART(weekday, @curdate) = 1 THEN @curdate 
WHEN DATEPART(weekday, @curdate) = 2 THEN dateadd(day, + 6, @curdate) 
WHEN DATEPART(weekday, @curdate) = 3 THEN dateadd(day, + 5, @curdate) 
WHEN DATEPART(weekday, @curdate) = 4 THEN dateadd(day, + 4, @curdate) 
WHEN DATEPART(weekday, @curdate) = 5 THEN dateadd(day, + 3, @curdate) 
WHEN DATEPART(weekday, @curdate) = 6 THEN dateadd(day, + 2, @curdate) 
WHEN DATEPART(weekday, @curdate) = 7 THEN dateadd(day, + 1, @curdate)
END

set @dateN = dateadd(dd, -6, @date)

SELECT
	[Дата_добавления_позиции] as ДатаПродажи,
	cast(format(Дата_время_добавления_позиции,'HH') as tinyint) as ЧасПродажи,
	[Код_магазина] as КодМагазина,
	case
		when (Код_товара &gt; 9999999999) or (Код_товара &lt; 0) then 0
		else Код_товара
	end as КодТовара,
	[Количество] as Количество,
    [Итоговая_сумма_после_применения_скидок] as Сумма
FROM 
	[cass].[v_fact_Детализация_чеков] as ch (nolock)
left join dbo.t_dim_Магазины as mag on mag.Код=ch.Код_магазина
where 
	[Дата_добавления_позиции] between @dateN and dateadd(day, 1, @date)
	and Возврат=0
and mag.Группа in ('Розница', 'РС Закрытие')</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.DWH]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.DWH]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[ДатаПродажи]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ДатаПродажи]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[ДатаПродажи]"
                              name="ДатаПродажи"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[ЧасПродажи]"
                              dataType="ui1"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ЧасПродажи]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[ЧасПродажи]"
                              name="ЧасПродажи"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                              dataType="i4"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                              name="КодМагазина"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]"
                              name="КодТовара"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[Количество]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[Количество]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[Количество]"
                              name="Количество"
                              precision="14"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[Сумма]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[Сумма]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[Сумма]"
                              name="Сумма"
                              precision="16"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ДатаПродажи]"
                              dataType="dbDate"
                              name="ДатаПродажи" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ЧасПродажи]"
                              dataType="ui1"
                              name="ЧасПродажи" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                              dataType="i4"
                              name="КодМагазина" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[Количество]"
                              dataType="numeric"
                              name="Количество"
                              precision="14"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].ExternalColumns[Сумма]"
                              dataType="numeric"
                              name="Сумма"
                              precision="16"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ДатаПродажи]"
                              dataType="dbDate"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ДатаПродажи]"
                              name="ДатаПродажи" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ЧасПродажи]"
                              dataType="ui1"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ЧасПродажи]"
                              name="ЧасПродажи" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                              dataType="i4"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                              name="КодМагазина" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                              dataType="i8"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                              name="КодТовара" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[Количество]"
                              dataType="numeric"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[Количество]"
                              name="Количество"
                              precision="14"
                              scale="3" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[Сумма]"
                              dataType="numeric"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[Сумма]"
                              name="Сумма"
                              precision="16"
                              scale="2" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                      description="Writes to a database using ADO.NET provider."
                      name="s8-olap-test OLAP_продажи"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."t_fact_Продажи_по_часам"</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].Columns[ДатаПродажи]"
                              cachedDataType="dbDate"
                              cachedName="ДатаПродажи"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[ДатаПродажи]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[ДатаПродажи]" />
                            <inputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].Columns[ЧасПродажи]"
                              cachedDataType="ui1"
                              cachedName="ЧасПродажи"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[ЧасПродажи]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[ЧасПродажи]" />
                            <inputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].Columns[КодМагазина]"
                              cachedDataType="i4"
                              cachedName="КодМагазина"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]" />
                            <inputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].Columns[КодТовара]"
                              cachedDataType="i8"
                              cachedName="КодТовара"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]" />
                            <inputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].Columns[Количество]"
                              cachedDataType="numeric"
                              cachedName="Количество"
                              cachedPrecision="14"
                              cachedScale="3"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[Количество]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[Количество]" />
                            <inputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].Columns[Сумма]"
                              cachedDataType="numeric"
                              cachedName="Сумма"
                              cachedPrecision="16"
                              cachedScale="2"
                              externalMetadataColumnId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[Сумма]"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output].Columns[Сумма]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[ДатаПродажи]"
                              dataType="dbTimeStamp"
                              name="ДатаПродажи" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[ЧасПродажи]"
                              dataType="ui1"
                              name="ЧасПродажи" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                              dataType="i8"
                              name="КодМагазина" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[Количество]"
                              dataType="numeric"
                              name="Количество"
                              precision="18"
                              scale="5" />
                            <externalMetadataColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input].ExternalColumns[Сумма]"
                              dataType="numeric"
                              name="Сумма"
                              precision="18"
                              scale="5" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ).Paths[ADO NET Source Output]"
                      endId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\КПТ\DWH Продажи.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{627FDA6F-04D5-4323-B673-777A57A04BEA}"
              DTS:From="Package\КПТ\DWH Продажи\Очистка таблиц"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\КПТ\ОТБРС"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{87F2FA88-5E07-417C-91A5-604BA3D45397}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="ОТБРС">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\КПТ\ОТБРС\Загрузка магазинов"
              DTS:CreationName="STOCK:SEQUENCE"
              DTS:Description="Контейнер последовательности"
              DTS:DTSID="{6EBB51CA-8BF1-459E-AF6F-424B57434C7D}"
              DTS:ExecutableType="STOCK:SEQUENCE"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка магазинов">
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка магазинов\s8-oalp-test Очистка таблицы Магазины_temp_load"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{ADD94EBD-2F1D-4FAC-AC84-9D5BBD152DC5}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="s8-oalp-test Очистка таблицы Магазины_temp_load"
                  DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
                  DTS:ThreadHint="2">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                      SQLTask:TimeOut="30"
                      SQLTask:SqlStatementSource="truncate table [kpt].[t_fact_Магазины_temp_load]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС"
                  DTS:CreationName="Microsoft.Pipeline"
                  DTS:Description="Data Flow Task"
                  DTS:DTSID="{D4259B01-2604-4E06-A8E8-DD364BB29004}"
                  DTS:ExecutableType="Microsoft.Pipeline"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Загрузка магазинов из ОТБРС"
                  DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <pipeline
                      BLOBTempStoragePath=""
                      bufferTempStoragePath=""
                      version="1">
                      <components>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                          description="Writes to a database using ADO.NET provider."
                          name="s8-olap-test Магазины_temp_load"
                          usesDispositions="true"
                          version="2">
                          <properties>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"kpt"."t_fact_Магазины_temp_load"</property>
                            <property
                              dataType="System.Int32"
                              description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                              expressionType="Notify"
                              name="BatchSize">0</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                              expressionType="Notify"
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                              expressionType="Notify"
                              name="UseBulkInsertWhenPossible">true</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input]"
                              errorRowDisposition="FailComponent"
                              hasSideEffects="true"
                              name="ADO NET Destination Input">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[Код]"
                                  cachedDataType="wstr"
                                  cachedLength="6"
                                  cachedName="Код"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[Магазин]"
                                  cachedDataType="wstr"
                                  cachedLength="40"
                                  cachedName="Магазин"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Магазин]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Магазин]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[Регион]"
                                  cachedDataType="wstr"
                                  cachedLength="40"
                                  cachedName="Регион"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Регион]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Регион]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[Куст]"
                                  cachedDataType="wstr"
                                  cachedLength="25"
                                  cachedName="Куст"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Куст]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Куст]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[Кустовой]"
                                  cachedDataType="wstr"
                                  cachedLength="40"
                                  cachedName="Кустовой"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Кустовой]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Кустовой]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[ДатаОткрытия]"
                                  cachedDataType="dbTimeStamp"
                                  cachedName="ДатаОткрытия"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаОткрытия]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаОткрытия]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[ДатаЗакрытия]"
                                  cachedDataType="dbTimeStamp"
                                  cachedName="ДатаЗакрытия"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаЗакрытия]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаЗакрытия]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[ДатаНачалаРеконструкции]"
                                  cachedDataType="dbTimeStamp"
                                  cachedName="ДатаНачалаРеконструкции"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаНачалаРеконструкции]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаНачалаРеконструкции]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[ДатаКонцаРеконструкции]"
                                  cachedDataType="dbTimeStamp"
                                  cachedName="ДатаКонцаРеконструкции"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаКонцаРеконструкции]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаКонцаРеконструкции]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[КатегорияПоПлощади]"
                                  cachedDataType="numeric"
                                  cachedName="КатегорияПоПлощади"
                                  cachedPrecision="2"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[КатегорияПоПлощади]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[КатегорияПоПлощади]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].Columns[ЧасовРаботы]"
                                  cachedDataType="numeric"
                                  cachedName="ЧасовРаботы"
                                  cachedPrecision="2"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ЧасовРаботы]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ЧасовРаботы]" />
                              </inputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  dataType="i8"
                                  name="Код" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Магазин]"
                                  dataType="wstr"
                                  length="40"
                                  name="Магазин" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Регион]"
                                  dataType="wstr"
                                  length="40"
                                  name="Регион" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Куст]"
                                  dataType="wstr"
                                  length="25"
                                  name="Куст" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Кустовой]"
                                  dataType="wstr"
                                  length="40"
                                  name="Кустовой" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаОткрытия]"
                                  dataType="dbTimeStamp"
                                  name="ДатаОткрытия" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаЗакрытия]"
                                  dataType="dbTimeStamp"
                                  name="ДатаЗакрытия" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаНачалаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  name="ДатаНачалаРеконструкции" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ДатаКонцаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  name="ДатаКонцаРеконструкции" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[КатегорияПоПлощади]"
                                  dataType="ui1"
                                  name="КатегорияПоПлощади" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ЧасовРаботы]"
                                  dataType="ui1"
                                  name="ЧасовРаботы" />
                              </externalMetadataColumns>
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Outputs[ADO NET Destination Error Output]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="ADO NET Destination Error Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                          description="Extracts data from a relational database by using a .NET provider."
                          name="ОТБРС"
                          usesDispositions="true"
                          version="4">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Specifies the SQL statement used by the component to extract data."
                              expressionType="Notify"
                              name="SqlCommand"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">select
	Магазины.code Код,
	Магазины.descr Магазин,
	Регионы.descr Регион,
                isnull(Куст.descr,'Не заyhgполнено') Куст,
               klient.descr Кустовой,
              Магазины.SP2843 ДатаОткрытия,
              Магазины.SP4225 ДатаЗакрытия,
              Магазины.SP4570 ДатаНачалаРеконструкции,
              Магазины.SP4571 ДатаКонцаРеконструкции,
              Магазины.SP2424 КатегорияПоПлощади,
Магазины.SP6383 ЧасовРаботы
from
	sc36 as Магазины (nolock)
left join sc3651 Куст  (nolock)
     on Магазины.sp3654=Куст.id

left join
	sc2400 as Регионы (nolock)
		on Регионы.id = Магазины.sp2222

left join SC36 as klient (nolock)
  on Куст.[SP4521]=klient.id


where
	Магазины.parentid = '     1   '
	and Регионы.descr not like 'ФРАНЧАЙЗИНГ%'</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                              name="AllowImplicitStringConversion">true</property>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                            <property
                              dataType="System.Int32"
                              description="Specify the mode to retrieve external column information"
                              name="AccessMode"
                              typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]"
                              name="ADO NET Source Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код]"
                                  length="6"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]"
                                  name="Код"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Магазин]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Магазин]"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Магазин]"
                                  name="Магазин"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Регион]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Регион]"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Регион]"
                                  name="Регион"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Куст]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Куст]"
                                  length="25"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Куст]"
                                  name="Куст"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Кустовой]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Кустовой]"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Кустовой]"
                                  name="Кустовой"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаОткрытия]"
                                  dataType="dbTimeStamp"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаОткрытия]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаОткрытия]"
                                  name="ДатаОткрытия"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаЗакрытия]"
                                  dataType="dbTimeStamp"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаЗакрытия]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаЗакрытия]"
                                  name="ДатаЗакрытия"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаНачалаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаНачалаРеконструкции]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаНачалаРеконструкции]"
                                  name="ДатаНачалаРеконструкции"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаКонцаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаКонцаРеконструкции]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ДатаКонцаРеконструкции]"
                                  name="ДатаКонцаРеконструкции"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[КатегорияПоПлощади]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[КатегорияПоПлощади]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[КатегорияПоПлощади]"
                                  name="КатегорияПоПлощади"
                                  precision="2"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ЧасовРаботы]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ЧасовРаботы]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ЧасовРаботы]"
                                  name="ЧасовРаботы"
                                  precision="2"
                                  truncationRowDisposition="FailComponent" />
                              </outputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код]"
                                  dataType="wstr"
                                  length="6"
                                  name="Код" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Магазин]"
                                  dataType="wstr"
                                  length="40"
                                  name="Магазин" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Регион]"
                                  dataType="wstr"
                                  length="40"
                                  name="Регион" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Куст]"
                                  dataType="wstr"
                                  length="25"
                                  name="Куст" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Кустовой]"
                                  dataType="wstr"
                                  length="40"
                                  name="Кустовой" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаОткрытия]"
                                  dataType="dbTimeStamp"
                                  name="ДатаОткрытия" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаЗакрытия]"
                                  dataType="dbTimeStamp"
                                  name="ДатаЗакрытия" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаНачалаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  name="ДатаНачалаРеконструкции" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ДатаКонцаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  name="ДатаКонцаРеконструкции" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[КатегорияПоПлощади]"
                                  dataType="numeric"
                                  name="КатегорияПоПлощади"
                                  precision="2" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ЧасовРаботы]"
                                  dataType="numeric"
                                  name="ЧасовРаботы"
                                  precision="2" />
                              </externalMetadataColumns>
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output]"
                              isErrorOut="true"
                              name="ADO NET Source Error Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код]"
                                  dataType="wstr"
                                  length="6"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код]"
                                  name="Код" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Магазин]"
                                  dataType="wstr"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Магазин]"
                                  name="Магазин" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Регион]"
                                  dataType="wstr"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Регион]"
                                  name="Регион" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Куст]"
                                  dataType="wstr"
                                  length="25"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Куст]"
                                  name="Куст" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Кустовой]"
                                  dataType="wstr"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Кустовой]"
                                  name="Кустовой" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаОткрытия]"
                                  dataType="dbTimeStamp"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаОткрытия]"
                                  name="ДатаОткрытия" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаЗакрытия]"
                                  dataType="dbTimeStamp"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаЗакрытия]"
                                  name="ДатаЗакрытия" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаНачалаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаНачалаРеконструкции]"
                                  name="ДатаНачалаРеконструкции" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаКонцаРеконструкции]"
                                  dataType="dbTimeStamp"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ДатаКонцаРеконструкции]"
                                  name="ДатаКонцаРеконструкции" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[КатегорияПоПлощади]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[КатегорияПоПлощади]"
                                  name="КатегорияПоПлощади"
                                  precision="2" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ЧасовРаботы]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ЧасовРаботы]"
                                  name="ЧасовРаботы"
                                  precision="2" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                      </components>
                      <paths>
                        <path
                          refId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС.Paths[ADO NET Source Output]"
                          endId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load.Inputs[ADO NET Destination Input]"
                          name="ADO NET Source Output"
                          startId="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]" />
                      </paths>
                    </pipeline>
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка магазинов\Слияние таблиц магазины"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{34857B2C-60DE-440A-A4A2-C5886082E0E0}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Слияние таблиц магазины"
                  DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
                  DTS:ThreadHint="2">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                      SQLTask:SqlStatementSource="MERGE [kpt].[t_fact_Магазины] AS Work&#xA;USING [kpt].[t_fact_Магазины_temp_load] AS Temp&#xA;ON (Work.Код = Temp.Код)&#xA;WHEN NOT MATCHED BY TARGET&#xA;    THEN INSERT(Код, Магазин, Регион, &#xA;&#x9;&#x9;&#x9;&#x9;Куст, Кустовой, ДатаОткрытия, &#xA;&#x9;&#x9;&#x9;&#x9;ДатаЗакрытия, ДатаНачалаРеконструкции, &#xA;&#x9;&#x9;&#x9;&#x9;ДатаКонцаРеконструкции, КатегорияПоПлощади,ЧасовРаботы)&#xA;&#x9;&#x9;VALUES(Temp.Код, Temp.Магазин, Temp.Регион, &#xA;&#x9;&#x9;&#x9;&#x9;Temp.Куст, Temp.Кустовой, Temp.ДатаОткрытия, &#xA;&#x9;&#x9;&#x9;&#x9;Temp.ДатаЗакрытия, Temp.ДатаНачалаРеконструкции, &#xA;&#x9;&#x9;&#x9;&#x9;Temp.ДатаКонцаРеконструкции, Temp.КатегорияПоПлощади,Temp.ЧасовРаботы)&#xA;WHEN MATCHED&#xA;    THEN UPDATE SET &#xA;    Work.Код = Temp.Код, &#xA;    Work.Магазин = Temp.Магазин, &#xA;    Work.Регион = Temp.Регион,&#xA;    Work.Куст = Temp.Куст,&#xA;    Work.Кустовой = Temp.Кустовой,&#xA;    Work.ДатаОткрытия = Temp.ДатаОткрытия,&#xA;    Work.ДатаЗакрытия = Temp.ДатаЗакрытия,&#xA;    Work.ДатаНачалаРеконструкции = Temp.ДатаНачалаРеконструкции,&#xA;    Work.ДатаКонцаРеконструкции = Temp.ДатаКонцаРеконструкции,&#xA;    Work.КатегорияПоПлощади = Temp.КатегорияПоПлощади,&#xA;Work.ЧасовРаботы = Temp.ЧасовРаботы&#x9;;&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:PrecedenceConstraints>
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка магазинов.PrecedenceConstraints[Constraint]"
                  DTS:CreationName=""
                  DTS:DTSID="{E7A3ABFD-74CF-4D6B-825C-AC8F1D9C139D}"
                  DTS:From="Package\КПТ\ОТБРС\Загрузка магазинов\s8-oalp-test Очистка таблицы Магазины_temp_load"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint"
                  DTS:To="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС" />
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка магазинов.PrecedenceConstraints[Constraint 1]"
                  DTS:CreationName=""
                  DTS:DTSID="{BBA06B7C-263D-4408-9027-6EA26A4C393E}"
                  DTS:From="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint 1"
                  DTS:To="Package\КПТ\ОТБРС\Загрузка магазинов\Слияние таблиц магазины" />
              </DTS:PrecedenceConstraints>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы"
              DTS:CreationName="STOCK:SEQUENCE"
              DTS:Description="Контейнер последовательности"
              DTS:DTSID="{C2075C30-AE67-424B-B322-5A8C17BDF5A6}"
              DTS:ExecutableType="STOCK:SEQUENCE"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка матрицы">
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы\s8-oalp-test Очистка таблицы ОТБРС_Матрица"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{DF567D97-2E3C-49AA-97BD-205D0A6A4FD7}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="s8-oalp-test Очистка таблицы ОТБРС_Матрица"
                  DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
                  DTS:ThreadHint="1">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                      SQLTask:TimeOut="30"
                      SQLTask:SqlStatementSource="truncate table [kpt].[t_fact_ОТБРС_Матрица]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1"
                  DTS:CreationName="Microsoft.Pipeline"
                  DTS:Description="Data Flow Task"
                  DTS:DTSID="{47ac9e9e-f880-409d-8f3a-79fd90c73de0}"
                  DTS:ExecutableType="Microsoft.Pipeline"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Загрузка матрицы  Признак 5 (отбор по дате) 1"
                  DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <pipeline
                      BLOBTempStoragePath=""
                      bufferTempStoragePath=""
                      version="1">
                      <components>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                          description="Extracts data from a relational database by using a .NET provider."
                          name="DWH"
                          usesDispositions="true"
                          version="4">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Specifies the SQL statement used by the component to extract data."
                              expressionType="Notify"
                              name="SqlCommand"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">set datefirst 7
declare @date as datetime
declare @dateN as datetime
declare @date2N as datetime
set @date = convert(varchar(16), dateadd(day, -1, getdate()), 112)
set @date = CASE 
  WHEN DATEPART(weekday, @date) = 1 THEN @date 
  WHEN DATEPART(weekday, @date) = 2 THEN dateadd(day, + 6, @date) 
  WHEN DATEPART(weekday, @date) = 3 THEN dateadd(day, + 5, @date) 
  WHEN DATEPART(weekday, @date) = 4 THEN dateadd(day, + 4, @date) 
  WHEN DATEPART(weekday, @date) = 5 THEN dateadd(day, + 3, @date) 
  WHEN DATEPART(weekday, @date) = 6 THEN dateadd(day, + 2, @date) 
  WHEN DATEPART(weekday, @date) = 7 THEN dateadd(day, + 1, @date)
END
set @dateN = dateadd(dd, -6, @date)
set @date2N = dateadd(dd, -13, @date)
Select
	Календарь.val Дата,
	КодТовара,
	КодПоставщика,
	КодМагазина,
	case 
		when
			ВидАсс = 3
		then
			1
		else
			0
	end ТОП,
	ВидАсс,
	ВидАсс2н,
	ВидПоставки
From
(
	Select
		cast(спрТовары.Code as bigint) КодТовара,
		cast(спрПоставщики.Code as bigint) КодПоставщика,
		cast(спрМагазины.Code as bigint) КодМагазина,
		(
select top 1
cast(c1721_vv.value as numeric(1, 0))
from
_1sconst as c1721_vv (nolock)
where
c1721_vv.id = 1721 and
c1721_vv.objid = спрТоварМатрица.ID and
(c1721_vv.date &lt;= @date)
order by c1721_vv.date desc, c1721_vv.time desc, c1721_vv.docid desc, c1721_vv.row_id desc
) ВидАсс,
		(
select top 1
cast(c1721_vv.value as numeric(1, 0))
from
_1sconst as c1721_vv (nolock)
where
c1721_vv.id = 1721 and
c1721_vv.objid = спрТоварМатрица.ID and
(c1721_vv.date &lt;= @date2N)
order by c1721_vv.date desc, c1721_vv.time desc, c1721_vv.docid desc, c1721_vv.row_id desc
) ВидАсс2н,
case when СпрТТ.Code is null then 0 else 
cast(СпрТТ.Code as bigint) end СпрТТ,
case when СпрТТТ.Code is null then 0 else
cast(СпрТТТ.Code as bigint) end СпрТТТ,
		case
			when 
				cast(спрПоставщики.Code as bigint) = 1682
			then
				1
			else
				0
		end ВидПоставки
	From
		sc1725 СпрТоварМатрица (NoLock)
	Left Join
		sc11 спрТовары (NoLock) On спрТовары.ID = спрТоварМатрица.ParentExt
	Left Join
		sc1718 спрАссМатрицы (NoLock) On спрАссМатрицы.ID = спрТоварМатрица.sp3600 
	Left Join
		sc36 спрМагазины (NoLock) On спрМагазины.ID = спрАссМатрицы.sp1746 
	Left Join
		sc36 СпрПоставщики (NoLock) On СпрПоставщики.ID = СпрТоварМатрица.sp1816 
	Left Join
		sc11 СпрТТ (NoLock) ON спрТовары.ParentID = СпрТТ.ID  
	Left join
		sc11 СпрТТТ (NoLock) ON СпрТТ.ParentID = СпрТТТ.ID  
	Where
		спрМагазины.ParentId = '     1   ' -- Магазин находится в группе розница
	and
		(
select top 1
cast(c1721_vv.value as numeric(1, 0))
from
_1sconst as c1721_vv (nolock)
where
c1721_vv.id = 1721 and
c1721_vv.objid = спрТоварМатрица.ID and
(c1721_vv.date &lt;= @date)
order by c1721_vv.date desc, c1721_vv.time desc, c1721_vv.docid desc, c1721_vv.row_id desc
) IN ('5','7') -- Имеет признак действующего ассортимента
		
) mdata
cross join dbo.GetTblDate(@dateN, @date) Календарь
where
		СпрТТ not in (3830,42,999999999,999999,34826,62962,10608,6306)
	and
		СпрТТТ  not in (3830,42,999999999,999999,34826,62962,10608,6306)

	and 
	(
	(
		СпрТТ  in (3061,16937,25892,60030,60032,153204,155885,156082 )
	or
		СпрТТТ  in (3061,16937,25892,60030,60032,153204,155885,156082 )
		) or (КодПоставщика &lt;&gt; 8793)
	)</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                              name="AllowImplicitStringConversion">true</property>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                            <property
                              dataType="System.Int32"
                              description="Specify the mode to retrieve external column information"
                              name="AccessMode"
                              typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output]"
                              name="ADO NET Source Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[Дата]"
                                  dataType="dbTimeStamp"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[Дата]"
                                  name="Дата"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]"
                                  name="КодТовара"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                                  name="КодПоставщика"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                                  name="КодМагазина"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ТОП]"
                                  dataType="i4"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ТОП]"
                                  name="ТОП"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                                  name="ВидАсс"
                                  precision="1"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс2н]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс2н]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс2н]"
                                  name="ВидАсс2н"
                                  precision="1"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                                  dataType="i4"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                                  name="ВидПоставки"
                                  truncationRowDisposition="FailComponent" />
                              </outputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                                  dataType="dbTimeStamp"
                                  name="Дата" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                                  dataType="i8"
                                  name="КодТовара" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                                  dataType="i8"
                                  name="КодПоставщика" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                                  dataType="i8"
                                  name="КодМагазина" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                                  dataType="i4"
                                  name="ТОП" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                                  dataType="numeric"
                                  name="ВидАсс"
                                  precision="1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс2н]"
                                  dataType="numeric"
                                  name="ВидАсс2н"
                                  precision="1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                                  dataType="i4"
                                  name="ВидПоставки" />
                              </externalMetadataColumns>
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output]"
                              isErrorOut="true"
                              name="ADO NET Source Error Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[Дата]"
                                  dataType="dbTimeStamp"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[Дата]"
                                  name="Дата" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                                  name="КодТовара" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                                  name="КодПоставщика" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                                  name="КодМагазина" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                                  name="ТОП" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                                  name="ВидАсс"
                                  precision="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс2н]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс2н]"
                                  name="ВидАсс2н"
                                  precision="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                                  name="ВидПоставки" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                          description="Writes to a database using ADO.NET provider."
                          name="s8-oalp-test ОТБРС_Матрица"
                          usesDispositions="true"
                          version="2">
                          <properties>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"kpt"."t_fact_ОТБРС_Матрица"</property>
                            <property
                              dataType="System.Int32"
                              description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                              expressionType="Notify"
                              name="BatchSize">0</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                              expressionType="Notify"
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                              expressionType="Notify"
                              name="UseBulkInsertWhenPossible">true</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input]"
                              errorRowDisposition="FailComponent"
                              hasSideEffects="true"
                              name="ADO NET Destination Input">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[Дата]"
                                  cachedDataType="dbTimeStamp"
                                  cachedName="Дата"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[Дата]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[КодТовара]"
                                  cachedDataType="i8"
                                  cachedName="КодТовара"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[КодПоставщика]"
                                  cachedDataType="i8"
                                  cachedName="КодПоставщика"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодПоставщика]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[КодМагазина]"
                                  cachedDataType="i8"
                                  cachedName="КодМагазина"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[ТОП]"
                                  cachedDataType="i4"
                                  cachedName="ТОП"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ТОП]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[ВидАсс]"
                                  cachedDataType="numeric"
                                  cachedName="ВидАсс"
                                  cachedPrecision="1"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[ВидПоставки]"
                                  cachedDataType="i4"
                                  cachedName="ВидПоставки"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output].Columns[ВидПоставки]" />
                              </inputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                                  dataType="dbTimeStamp"
                                  name="Дата" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                                  dataType="i8"
                                  name="КодТовара" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                                  dataType="i8"
                                  name="КодПоставщика" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                                  dataType="i8"
                                  name="КодМагазина" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                                  dataType="bool"
                                  name="ТОП" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                                  dataType="ui1"
                                  name="ВидАсс" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс14денейНазад]"
                                  dataType="ui1"
                                  name="ВидАсс14денейНазад" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                                  dataType="bool"
                                  name="ВидПоставки" />
                              </externalMetadataColumns>
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="ADO NET Destination Error Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                      </components>
                      <paths>
                        <path
                          refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1.Paths[ADO NET Source Output]"
                          endId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input]"
                          name="ADO NET Source Output"
                          startId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH.Outputs[ADO NET Source Output]" />
                      </paths>
                    </pipeline>
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)"
                  DTS:CreationName="Microsoft.Pipeline"
                  DTS:Description="Data Flow Task"
                  DTS:DTSID="{00D93379-5DCE-43E1-9E57-FA51A06175F9}"
                  DTS:ExecutableType="Microsoft.Pipeline"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Загрузка матрицы из DWH (отбор по дате)"
                  DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <pipeline
                      BLOBTempStoragePath=""
                      bufferTempStoragePath=""
                      version="1">
                      <components>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                          description="Extracts data from a relational database by using a .NET provider."
                          name="DWH"
                          usesDispositions="true"
                          version="4">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Specifies the SQL statement used by the component to extract data."
                              expressionType="Notify"
                              name="SqlCommand"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">set datefirst 7
declare @date as datetime
declare @dateN as datetime
declare @date2N as datetime
set @date = convert(varchar(16), dateadd(day, -1, getdate()), 112)
set @date = CASE 
  WHEN DATEPART(weekday, @date) = 1 THEN @date 
  WHEN DATEPART(weekday, @date) = 2 THEN dateadd(day, + 6, @date) 
  WHEN DATEPART(weekday, @date) = 3 THEN dateadd(day, + 5, @date) 
  WHEN DATEPART(weekday, @date) = 4 THEN dateadd(day, + 4, @date) 
  WHEN DATEPART(weekday, @date) = 5 THEN dateadd(day, + 3, @date) 
  WHEN DATEPART(weekday, @date) = 6 THEN dateadd(day, + 2, @date) 
  WHEN DATEPART(weekday, @date) = 7 THEN dateadd(day, + 1, @date)
END
set @dateN = dateadd(dd, -6, @date)
set @date2N = dateadd(dd, -13, @date)
Select
	Календарь.val Дата,
	КодТовара,
	КодПоставщика,
	КодМагазина,
	case 
		when
			ВидАсс = 3
		then
			1
		else
			0
	end ТОП,
	ВидАсс,
	ВидАсс2н,
	ВидПоставки
From
(
	Select
		cast(спрТовары.Code as bigint) КодТовара,
		cast(спрПоставщики.Code as bigint) КодПоставщика,
		cast(спрМагазины.Code as bigint) КодМагазина,
		(
select top 1
cast(c1721_vv.value as numeric(1, 0))
from
_1sconst as c1721_vv (nolock)
where
c1721_vv.id = 1721 and
c1721_vv.objid = спрТоварМатрица.ID and
(c1721_vv.date &lt;= @date)
order by c1721_vv.date desc, c1721_vv.time desc, c1721_vv.docid desc, c1721_vv.row_id desc
) ВидАсс,
		(
select top 1
cast(c1721_vv.value as numeric(1, 0))
from
_1sconst as c1721_vv (nolock)
where
c1721_vv.id = 1721 and
c1721_vv.objid = спрТоварМатрица.ID and
(c1721_vv.date &lt;= @date2N)
order by c1721_vv.date desc, c1721_vv.time desc, c1721_vv.docid desc, c1721_vv.row_id desc
) ВидАсс2н,
case when СпрТТ.Code is null then 0 else 
cast(СпрТТ.Code as bigint) end СпрТТ,
case when СпрТТТ.Code is null then 0 else
cast(СпрТТТ.Code as bigint) end СпрТТТ,
		case
			when 
				cast(спрПоставщики.Code as bigint) = 1682
			then
				1
			else
				0
		end ВидПоставки
	From
		sc1725 СпрТоварМатрица (NoLock)
	Left Join
		sc11 спрТовары (NoLock) On спрТовары.ID = спрТоварМатрица.ParentExt
	Left Join
		sc1718 спрАссМатрицы (NoLock) On спрАссМатрицы.ID = спрТоварМатрица.sp3600 
	Left Join
		sc36 спрМагазины (NoLock) On спрМагазины.ID = спрАссМатрицы.sp1746 
	Left Join
		sc36 СпрПоставщики (NoLock) On СпрПоставщики.ID = СпрТоварМатрица.sp1816 
	Left Join
		sc11 СпрТТ (NoLock) ON спрТовары.ParentID = СпрТТ.ID  
	Left join
		sc11 СпрТТТ (NoLock) ON СпрТТ.ParentID = СпрТТТ.ID  
	Where
		спрМагазины.ParentId = '     1   ' -- Магазин находится в группе розница
	and
		(
select top 1
cast(c1721_vv.value as numeric(1, 0))
from
_1sconst as c1721_vv (nolock)
where
c1721_vv.id = 1721 and
c1721_vv.objid = спрТоварМатрица.ID and
(c1721_vv.date &lt;= @date)
order by c1721_vv.date desc, c1721_vv.time desc, c1721_vv.docid desc, c1721_vv.row_id desc
) IN ('2','3','4','6','9') -- Имеет признак действующего ассортимента
		and(
		(
select top 1
cast(c1721_vv.value as numeric(1, 0))
from
_1sconst as c1721_vv (nolock)
where
c1721_vv.id = 1721 and
c1721_vv.objid = спрТоварМатрица.ID and
(c1721_vv.date &lt;= @date2N)
order by c1721_vv.date desc, c1721_vv.time desc, c1721_vv.docid desc, c1721_vv.row_id desc
) IN ('2','3','4','6','9') )
  -- Имел признак действующего ассортимента 2 недели назад
) mdata
cross join dbo.GetTblDate(@dateN, @date) Календарь
where
		СпрТТ not in (3830,42,999999999,999999,34826,62962,10608,6306)
	and
		СпрТТТ  not in (3830,42,999999999,999999,34826,62962,10608,6306)

	and 
	(
	(
		СпрТТ  in (3061,16937,25892,60030,60032,153204,155885,156082 )
	or
		СпрТТТ  in (3061,16937,25892,60030,60032,153204,155885,156082 )
		) or (КодПоставщика &lt;&gt; 8793)
	)</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                              name="AllowImplicitStringConversion">true</property>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                            <property
                              dataType="System.Int32"
                              description="Specify the mode to retrieve external column information"
                              name="AccessMode"
                              typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output]"
                              name="ADO NET Source Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[Дата]"
                                  dataType="dbTimeStamp"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[Дата]"
                                  name="Дата"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]"
                                  name="КодТовара"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                                  name="КодПоставщика"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                                  name="КодМагазина"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ТОП]"
                                  dataType="i4"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ТОП]"
                                  name="ТОП"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                                  name="ВидАсс"
                                  precision="1"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс2н]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс2н]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс2н]"
                                  name="ВидАсс2н"
                                  precision="1"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                                  dataType="i4"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                                  name="ВидПоставки"
                                  truncationRowDisposition="FailComponent" />
                              </outputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                                  dataType="dbTimeStamp"
                                  name="Дата" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                                  dataType="i8"
                                  name="КодТовара" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                                  dataType="i8"
                                  name="КодПоставщика" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                                  dataType="i8"
                                  name="КодМагазина" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                                  dataType="i4"
                                  name="ТОП" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                                  dataType="numeric"
                                  name="ВидАсс"
                                  precision="1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс2н]"
                                  dataType="numeric"
                                  name="ВидАсс2н"
                                  precision="1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                                  dataType="i4"
                                  name="ВидПоставки" />
                              </externalMetadataColumns>
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output]"
                              isErrorOut="true"
                              name="ADO NET Source Error Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[Дата]"
                                  dataType="dbTimeStamp"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[Дата]"
                                  name="Дата" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                                  name="КодТовара" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                                  name="КодПоставщика" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                                  name="КодМагазина" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                                  name="ТОП" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                                  name="ВидАсс"
                                  precision="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс2н]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ВидАсс2н]"
                                  name="ВидАсс2н"
                                  precision="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                                  name="ВидПоставки" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                          description="Writes to a database using ADO.NET provider."
                          name="s8-oalp-test ОТБРС_Матрица"
                          usesDispositions="true"
                          version="2">
                          <properties>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"kpt"."t_fact_ОТБРС_Матрица"</property>
                            <property
                              dataType="System.Int32"
                              description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                              expressionType="Notify"
                              name="BatchSize">0</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                              expressionType="Notify"
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                              expressionType="Notify"
                              name="UseBulkInsertWhenPossible">true</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input]"
                              errorRowDisposition="FailComponent"
                              hasSideEffects="true"
                              name="ADO NET Destination Input">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[Дата]"
                                  cachedDataType="dbTimeStamp"
                                  cachedName="Дата"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[Дата]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[КодТовара]"
                                  cachedDataType="i8"
                                  cachedName="КодТовара"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодТовара]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[КодПоставщика]"
                                  cachedDataType="i8"
                                  cachedName="КодПоставщика"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодПоставщика]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[КодМагазина]"
                                  cachedDataType="i8"
                                  cachedName="КодМагазина"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[КодМагазина]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[ТОП]"
                                  cachedDataType="i4"
                                  cachedName="ТОП"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ТОП]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[ВидАсс]"
                                  cachedDataType="numeric"
                                  cachedName="ВидАсс"
                                  cachedPrecision="1"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидАсс]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].Columns[ВидПоставки]"
                                  cachedDataType="i4"
                                  cachedName="ВидПоставки"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output].Columns[ВидПоставки]" />
                              </inputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                                  dataType="dbTimeStamp"
                                  name="Дата" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                                  dataType="i8"
                                  name="КодТовара" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                                  dataType="i8"
                                  name="КодПоставщика" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                                  dataType="i8"
                                  name="КодМагазина" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                                  dataType="bool"
                                  name="ТОП" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                                  dataType="ui1"
                                  name="ВидАсс" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс14денейНазад]"
                                  dataType="ui1"
                                  name="ВидАсс14денейНазад" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                                  dataType="bool"
                                  name="ВидПоставки" />
                              </externalMetadataColumns>
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="ADO NET Destination Error Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                      </components>
                      <paths>
                        <path
                          refId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате).Paths[ADO NET Source Output]"
                          endId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица.Inputs[ADO NET Destination Input]"
                          name="ADO NET Source Output"
                          startId="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH.Outputs[ADO NET Source Output]" />
                      </paths>
                    </pipeline>
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы\Задача &quot;Выполнение SQL&quot;"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Задача &quot;Выполнение SQL&quot;"
                  DTS:DTSID="{26FEB462-16DD-40B2-B9F5-919EAB102074}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Задача &quot;Выполнение SQL&quot;"
                  DTS:ThreadHint="1">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{0A9C0910-30E2-4287-9B51-ABD08498C0E8}"
                      SQLTask:SqlStatementSource="&#xA;  delete [kpt].[t_fact_ОТБРС_Матрица] FROM [kpt].[t_fact_ОТБРС_Матрица] matr&#xA;  where matr.Кодтовара not in (select КодТовара &#xA;&#x9;from&#xA;&#x9;t_fact_Важный_товар vt &#xA;&#x9;where vt.КодМагазина=matr.КодМагазина and vt.ДатаНачала&lt;=matr.Дата and vt.ДатаКонца&gt;=matr.Дата)  and ВидАсс=5 " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:PrecedenceConstraints>
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы.PrecedenceConstraints[Constraint]"
                  DTS:CreationName=""
                  DTS:DTSID="{844DEBFC-EDB1-41DB-806D-F5660FB349DB}"
                  DTS:From="Package\КПТ\ОТБРС\Загрузка матрицы\s8-oalp-test Очистка таблицы ОТБРС_Матрица"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint"
                  DTS:To="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)" />
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы.PrecedenceConstraints[Constraint 1]"
                  DTS:CreationName=""
                  DTS:DTSID="{04E14333-65C4-44E6-89A3-F82C4068DC01}"
                  DTS:From="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint 1"
                  DTS:To="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1" />
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка матрицы.PrecedenceConstraints[Constraint 2]"
                  DTS:CreationName=""
                  DTS:DTSID="{36B3A3E2-ADCA-4DF8-B15B-78CC2DFAF5DF}"
                  DTS:From="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint 2"
                  DTS:To="Package\КПТ\ОТБРС\Загрузка матрицы\Задача &quot;Выполнение SQL&quot;" />
              </DTS:PrecedenceConstraints>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\ОТБРС\Загрузка МК"
              DTS:CreationName="STOCK:SEQUENCE"
              DTS:Description="Контейнер последовательности"
              DTS:DTSID="{EB46419A-1F8C-4C8D-9FCF-0F1E6091BBD7}"
              DTS:ExecutableType="STOCK:SEQUENCE"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка МК">
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС"
                  DTS:CreationName="Microsoft.Pipeline"
                  DTS:Description="Data Flow Task"
                  DTS:DTSID="{D28D9EC6-9D97-48F0-9C22-EF4292B9BC6E}"
                  DTS:ExecutableType="Microsoft.Pipeline"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Загрузка маркетингового классификатора из ОТБРС"
                  DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <pipeline
                      BLOBTempStoragePath=""
                      bufferTempStoragePath=""
                      version="1">
                      <components>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                          description="Writes to a database using ADO.NET provider."
                          name="s8-olap-test Маркетинговый классификатор"
                          usesDispositions="true"
                          version="2">
                          <properties>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"kpt"."t_fact_МаркетинговыйКлассификатор"</property>
                            <property
                              dataType="System.Int32"
                              description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                              expressionType="Notify"
                              name="BatchSize">0</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                              expressionType="Notify"
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                              expressionType="Notify"
                              name="UseBulkInsertWhenPossible">true</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input]"
                              errorRowDisposition="FailComponent"
                              hasSideEffects="true"
                              name="ADO NET Destination Input">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].Columns[ID]"
                                  cachedDataType="wstr"
                                  cachedLength="9"
                                  cachedName="ID"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].ExternalColumns[id]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ID]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].Columns[CODE]"
                                  cachedDataType="wstr"
                                  cachedLength="10"
                                  cachedName="CODE"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[CODE]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].Columns[DESCR]"
                                  cachedDataType="wstr"
                                  cachedLength="100"
                                  cachedName="DESCR"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].ExternalColumns[Наименование]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[DESCR]" />
                              </inputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].ExternalColumns[id]"
                                  dataType="wstr"
                                  length="9"
                                  name="id" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  dataType="i8"
                                  name="Код" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input].ExternalColumns[Наименование]"
                                  dataType="wstr"
                                  length="100"
                                  name="Наименование" />
                              </externalMetadataColumns>
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Outputs[ADO NET Destination Error Output]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="ADO NET Destination Error Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                          description="Extracts data from a relational database by using a .NET provider."
                          name="ОТБРС"
                          usesDispositions="true"
                          version="4">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Specifies the SQL statement used by the component to extract data."
                              expressionType="Notify"
                              name="SqlCommand"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT     ID, CODE, DESCR
FROM         SC5650 (nolock)</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                              name="AllowImplicitStringConversion">true</property>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                            <property
                              dataType="System.Int32"
                              description="Specify the mode to retrieve external column information"
                              name="AccessMode"
                              typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]"
                              name="ADO NET Source Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ID]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ID]"
                                  length="9"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ID]"
                                  name="ID"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[CODE]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[CODE]"
                                  length="10"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[CODE]"
                                  name="CODE"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[DESCR]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[DESCR]"
                                  length="100"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[DESCR]"
                                  name="DESCR"
                                  truncationRowDisposition="FailComponent" />
                              </outputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ID]"
                                  dataType="wstr"
                                  length="9"
                                  name="ID" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[CODE]"
                                  dataType="wstr"
                                  length="10"
                                  name="CODE" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[DESCR]"
                                  dataType="wstr"
                                  length="100"
                                  name="DESCR" />
                              </externalMetadataColumns>
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output]"
                              isErrorOut="true"
                              name="ADO NET Source Error Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ID]"
                                  dataType="wstr"
                                  length="9"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ID]"
                                  name="ID" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[CODE]"
                                  dataType="wstr"
                                  length="10"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[CODE]"
                                  name="CODE" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[DESCR]"
                                  dataType="wstr"
                                  length="100"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[DESCR]"
                                  name="DESCR" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                      </components>
                      <paths>
                        <path
                          refId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС.Paths[ADO NET Source Output]"
                          endId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор.Inputs[ADO NET Destination Input]"
                          name="ADO NET Source Output"
                          startId="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]" />
                      </paths>
                    </pipeline>
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка МК\Очистка таблицы маркетинговый классфикатор и добавление значения &quot;Не заполнено&quot;"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{3BCB393A-BE17-461E-8B67-0E8652D1207E}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Очистка таблицы маркетинговый классфикатор и добавление значения &quot;Не заполнено&quot;"
                  DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
                  DTS:ThreadHint="3">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                      SQLTask:TimeOut="30"
                      SQLTask:SqlStatementSource="truncate table [kpt].[t_fact_МаркетинговыйКлассификатор];&#xA;insert into [kpt].[t_fact_МаркетинговыйКлассификатор](id, Код, Наименование)&#xA; values('      999', '    0', 'Не заполнено')" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:PrecedenceConstraints>
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка МК.PrecedenceConstraints[Constraint]"
                  DTS:CreationName=""
                  DTS:DTSID="{34CE8714-39D6-4722-B087-B3F2175DC346}"
                  DTS:From="Package\КПТ\ОТБРС\Загрузка МК\Очистка таблицы маркетинговый классфикатор и добавление значения &quot;Не заполнено&quot;"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint"
                  DTS:To="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС" />
              </DTS:PrecedenceConstraints>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\ОТБРС\Загрузка товаров"
              DTS:CreationName="STOCK:SEQUENCE"
              DTS:Description="Контейнер последовательности"
              DTS:DTSID="{EE5BC7B1-B6BE-4275-9F8D-2E5743C44BE1}"
              DTS:ExecutableType="STOCK:SEQUENCE"
              DTS:LocaleID="-1"
              DTS:ObjectName="Загрузка товаров">
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка товаров\s8-oalp-test Очистка таблицы Товары"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{E25B8A82-EB08-4C46-80C7-6FE943D992DC}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="s8-oalp-test Очистка таблицы Товары"
                  DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
                  DTS:ThreadHint="4">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                      SQLTask:TimeOut="30"
                      SQLTask:SqlStatementSource="truncate table [kpt].[t_fact_Товары]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС"
                  DTS:CreationName="Microsoft.Pipeline"
                  DTS:Description="Data Flow Task"
                  DTS:DTSID="{3D5DCF5F-FA35-4C51-A946-6D72CA3CCFE3}"
                  DTS:ExecutableType="Microsoft.Pipeline"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Загрузка товаров из ОТБРС"
                  DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <pipeline
                      BLOBTempStoragePath=""
                      bufferTempStoragePath=""
                      version="1">
                      <components>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                          description="Writes to a database using ADO.NET provider."
                          name="s8-olap-test Товары"
                          usesDispositions="true"
                          version="2">
                          <properties>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"kpt"."t_fact_Товары"</property>
                            <property
                              dataType="System.Int32"
                              description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                              expressionType="Notify"
                              name="BatchSize">0</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                              expressionType="Notify"
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                              expressionType="Notify"
                              name="UseBulkInsertWhenPossible">true</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input]"
                              errorRowDisposition="FailComponent"
                              hasSideEffects="true"
                              name="ADO NET Destination Input">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Код]"
                                  cachedDataType="i8"
                                  cachedName="Код"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Товар]"
                                  cachedDataType="wstr"
                                  cachedLength="68"
                                  cachedName="Товар"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Товар]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Товар]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Родитель]"
                                  cachedDataType="wstr"
                                  cachedLength="10"
                                  cachedName="Родитель"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Родитель]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Родитель]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Менеджер]"
                                  cachedDataType="wstr"
                                  cachedLength="40"
                                  cachedName="Менеджер"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Менеджер]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Менеджер]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[СТМ]"
                                  cachedDataType="numeric"
                                  cachedName="СТМ"
                                  cachedPrecision="1"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[СТМ]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[СТМ]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Код_Группы_Уровень_2]"
                                  cachedDataType="i8"
                                  cachedName="Код_Группы_Уровень_2"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Код_Группы_Уровень_2]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код_Группы_Уровень_2]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Имя_Группы_Уровень_2]"
                                  cachedDataType="wstr"
                                  cachedLength="68"
                                  cachedName="Имя_Группы_Уровень_2"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Имя_Группы_Уровень_2]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Имя_Группы_Уровень_2]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Код_Группы_Уровень_1]"
                                  cachedDataType="numeric"
                                  cachedName="Код_Группы_Уровень_1"
                                  cachedPrecision="19"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Код_Группы_Уровень_1]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код_Группы_Уровень_1]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Имя_Группы_Уровень_1]"
                                  cachedDataType="wstr"
                                  cachedLength="68"
                                  cachedName="Имя_Группы_Уровень_1"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Имя_Группы_Уровень_1]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Имя_Группы_Уровень_1]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[КодГлавныйДляАвтозаказа]"
                                  cachedDataType="i8"
                                  cachedName="КодГлавныйДляАвтозаказа"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[КодГлавныйДляАвтозаказа]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[КодГлавныйДляАвтозаказа]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  cachedDataType="numeric"
                                  cachedName="ПорогПродажДляРасчетаКоэффПродаж"
                                  cachedPrecision="2"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ПорогПродажДляРасчетаКоэффПродаж]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].Columns[Copy of СвежийТовар]"
                                  cachedDataType="ui1"
                                  cachedName="Copy of СвежийТовар"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[СвежийТовар]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Output].Columns[Copy of СвежийТовар]" />
                              </inputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  dataType="i8"
                                  name="Код" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Товар]"
                                  dataType="wstr"
                                  length="68"
                                  name="Товар" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Родитель]"
                                  dataType="i8"
                                  name="Родитель" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[СвежийТовар]"
                                  dataType="ui1"
                                  name="СвежийТовар" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[СТМ]"
                                  dataType="ui1"
                                  name="СТМ" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Менеджер]"
                                  dataType="wstr"
                                  length="40"
                                  name="Менеджер" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Код_Группы_Уровень_2]"
                                  dataType="i8"
                                  name="Код_Группы_Уровень_2" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Имя_Группы_Уровень_2]"
                                  dataType="wstr"
                                  length="68"
                                  name="Имя_Группы_Уровень_2" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Код_Группы_Уровень_1]"
                                  dataType="i8"
                                  name="Код_Группы_Уровень_1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[Имя_Группы_Уровень_1]"
                                  dataType="wstr"
                                  length="68"
                                  name="Имя_Группы_Уровень_1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[КодГлавныйДляАвтозаказа]"
                                  dataType="i8"
                                  name="КодГлавныйДляАвтозаказа" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[МаркетинговыйКлассификатор]"
                                  dataType="wstr"
                                  length="9"
                                  name="МаркетинговыйКлассификатор" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input].ExternalColumns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  dataType="ui1"
                                  name="ПорогПродажДляРасчетаКоэффПродаж" />
                              </externalMetadataColumns>
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Outputs[ADO NET Destination Error Output]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="ADO NET Destination Error Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов"
                          componentClassID="Microsoft.DataConvert"
                          contactInfo="Data Conversion;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
                          description="Data Conversion"
                          name="Конвертация типов"
                          usesDispositions="true">
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Inputs[Data Conversion Input]"
                              name="Data Conversion Input">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Inputs[Data Conversion Input].Columns[СвежийТовар]"
                                  cachedDataType="i4"
                                  cachedName="СвежийТовар"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[СвежийТовар]" />
                              </inputColumns>
                              <externalMetadataColumns />
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Output]"
                              exclusionGroup="1"
                              name="Data Conversion Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Inputs[Data Conversion Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Output].Columns[Copy of СвежийТовар]"
                                  dataType="ui1"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Output].Columns[Copy of СвежийТовар]"
                                  name="Copy of СвежийТовар"
                                  truncationRowDisposition="FailComponent">
                                  <properties>
                                    <property
                                      containsID="true"
                                      dataType="System.Int32"
                                      description="Указывает входной столбец, служащий источником данных для преобразования."
                                      name="SourceInputColumnLineageID">#{Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[СвежийТовар]}</property>
                                    <property
                                      dataType="System.Boolean"
                                      description="Указывает, используются ли в столбце более производительные, не зависящие от локалей процедуры синтаксического анализа."
                                      name="FastParse">false</property>
                                  </properties>
                                </outputColumn>
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Error Output]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="Data Conversion Error Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Inputs[Data Conversion Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                          description="Extracts data from a relational database by using a .NET provider."
                          name="ОТБРС"
                          usesDispositions="true"
                          version="4">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Specifies the SQL statement used by the component to extract data."
                              expressionType="Notify"
                              name="SqlCommand"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">-- говнокод от предков --

-- чувак, если ты его перепишешь, ты герой! --

select
cast(Товары.code as bigint) Код,
'[' + cast(Товары.code as varchar(10)) + '] ' + ltrim(rtrim(Товары.descr)) Товар,
 Группы.code Родитель,
(Select SC36.Descr
 From SC36
 Where SC36.ID = (CASE when  Группы.parentid = '     0   ' THEN  Группы.SP1404 ELSE ГруппыВерхнегоУровня.SP1404 
			END)) as Менеджер,
 case when (case when Группы.Parentid = '     0   ' then Группы.sp3124 else ГруппыВерхнегоУровня.sp3124 end)&gt;0 then 1 else 0 end СвежийТовар,
 Товары.SP2729 СТМ
 ,case when ГруппыВерхнегоУровня.Code IS NULL then -1 else cast(Группы.Code as bigint) end Код_Группы_Уровень_2
 ,case when ГруппыВерхнегоУровня.Code IS NULL then 'Прайд-А' else '[' + cast(Группы.Code as varchar(10)) + '] ' + ltrim(rtrim(Группы.Descr)) end Имя_Группы_Уровень_2
 ,case when ГруппыВерхнегоУровня.Code IS NULL then cast(Группы.Code as bigint) else cast(ГруппыВерхнегоУровня.Code as decimal(10,0)) end  Код_Группы_Уровень_1
 ,case when ГруппыВерхнегоУровня.Code IS NULL then  '[' + cast(Группы.Code as varchar(10)) + '] ' + ltrim(rtrim(Группы.Descr)) 
                                                   else  '[' + cast(ГруппыВерхнегоУровня.Code as varchar(10)) + '] ' + ltrim(rtrim(ГруппыВерхнегоУровня.Descr)) end Имя_Группы_Уровень_1
,cast(ГлДляАвтозаказа.code as bigint) КодГлавныйДляАвтозаказа
, case
		when (Товары.SP5648 is null) or (Товары.SP5648 = '     0   ') then '      999'
		else Товары.SP5648
	end MarketClass_ID
,Товары .SP6212 as ПорогПродажДляРасчетаКоэффПродаж

from
 sc11 as Товары (nolock)
left join
 sc11 as Группы (nolock)
  on Товары.parentid = Группы.id
 left join
sc11 as ГруппыВерхнегоУровня (nolock)
	on Группы.parentid = ГруппыВерхнегоУровня.id
left join
 sc11 as ГлДляАвтозаказа (nolock)
	on ГлДляАвтозаказа.ID = Товары.SP2938
WHERE Товары.isFolder&lt;&gt;1

UNION ALL
select
 cast(Товары.code as bigint) Код,
'[' + cast(Товары.code as varchar(10)) + '] ' + ltrim(rtrim(Товары.descr)) Товар,
 Группы.code Родитель,
 NULL as Менеджер,
 0 СвежийТовар,
 Товары.SP2729 СТМ
 ,cast(Товары.Code as bigint) Код_Группы_Уровень_2
 , '[' + cast(Товары.Code as varchar(10)) + '] ' + ltrim(rtrim(Товары.Descr)) Имя_Группы_Уровень_2
 ,case when Группы.Code IS NULL then Товары.Code else cast(Группы.Code as bigint) end  Код_Группы_Уровень_1
 ,case when Группы.Code IS NULL then '[' + cast(Товары.Code as varchar(10)) + '] ' + ltrim(rtrim(Товары.Descr)) 
                 else  '[' + cast(Группы.Code as varchar(10)) + '] ' + ltrim(rtrim(Группы.Descr)) end Имя_Группы_Уровень_1
,null КодГлавныйДляАвтозаказа
, case
		when (Товары.SP5648 is null) or (Товары.SP5648 = '     0   ') then '      999'
		else Товары.SP5648
	end MarketClass_ID
,Товары .SP6212 as ПорогПродажДляРасчетаКоэффПродаж
from
 sc11 as Товары (nolock)
left join
 sc11 as Группы (nolock)
  on Товары.parentid = Группы.id
WHERE Товары.isFolder=1</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                              name="AllowImplicitStringConversion">true</property>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                            <property
                              dataType="System.Int32"
                              description="Specify the mode to retrieve external column information"
                              name="AccessMode"
                              typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]"
                              name="ADO NET Source Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]"
                                  name="Код"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Товар]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Товар]"
                                  length="68"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Товар]"
                                  name="Товар"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Родитель]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Родитель]"
                                  length="10"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Родитель]"
                                  name="Родитель"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Менеджер]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Менеджер]"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Менеджер]"
                                  name="Менеджер"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[СвежийТовар]"
                                  dataType="i4"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[СвежийТовар]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[СвежийТовар]"
                                  name="СвежийТовар"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[СТМ]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[СТМ]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[СТМ]"
                                  name="СТМ"
                                  precision="1"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код_Группы_Уровень_2]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код_Группы_Уровень_2]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код_Группы_Уровень_2]"
                                  name="Код_Группы_Уровень_2"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Имя_Группы_Уровень_2]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Имя_Группы_Уровень_2]"
                                  length="68"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Имя_Группы_Уровень_2]"
                                  name="Имя_Группы_Уровень_2"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код_Группы_Уровень_1]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код_Группы_Уровень_1]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код_Группы_Уровень_1]"
                                  name="Код_Группы_Уровень_1"
                                  precision="19"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Имя_Группы_Уровень_1]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Имя_Группы_Уровень_1]"
                                  length="68"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Имя_Группы_Уровень_1]"
                                  name="Имя_Группы_Уровень_1"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[КодГлавныйДляАвтозаказа]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[КодГлавныйДляАвтозаказа]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[КодГлавныйДляАвтозаказа]"
                                  name="КодГлавныйДляАвтозаказа"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[MarketClass_ID]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[MarketClass_ID]"
                                  length="9"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[MarketClass_ID]"
                                  name="MarketClass_ID"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  name="ПорогПродажДляРасчетаКоэффПродаж"
                                  precision="2"
                                  truncationRowDisposition="FailComponent" />
                              </outputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код]"
                                  dataType="i8"
                                  name="Код" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Товар]"
                                  dataType="wstr"
                                  length="68"
                                  name="Товар" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Родитель]"
                                  dataType="wstr"
                                  length="10"
                                  name="Родитель" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Менеджер]"
                                  dataType="wstr"
                                  length="40"
                                  name="Менеджер" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[СвежийТовар]"
                                  dataType="i4"
                                  name="СвежийТовар" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[СТМ]"
                                  dataType="numeric"
                                  name="СТМ"
                                  precision="1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код_Группы_Уровень_2]"
                                  dataType="i8"
                                  name="Код_Группы_Уровень_2" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Имя_Группы_Уровень_2]"
                                  dataType="wstr"
                                  length="68"
                                  name="Имя_Группы_Уровень_2" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код_Группы_Уровень_1]"
                                  dataType="numeric"
                                  name="Код_Группы_Уровень_1"
                                  precision="19" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Имя_Группы_Уровень_1]"
                                  dataType="wstr"
                                  length="68"
                                  name="Имя_Группы_Уровень_1" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[КодГлавныйДляАвтозаказа]"
                                  dataType="i8"
                                  name="КодГлавныйДляАвтозаказа" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[MarketClass_ID]"
                                  dataType="wstr"
                                  length="9"
                                  name="MarketClass_ID" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  dataType="numeric"
                                  name="ПорогПродажДляРасчетаКоэффПродаж"
                                  precision="2" />
                              </externalMetadataColumns>
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output]"
                              isErrorOut="true"
                              name="ADO NET Source Error Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код]"
                                  name="Код" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Товар]"
                                  dataType="wstr"
                                  length="68"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Товар]"
                                  name="Товар" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Родитель]"
                                  dataType="wstr"
                                  length="10"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Родитель]"
                                  name="Родитель" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Менеджер]"
                                  dataType="wstr"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Менеджер]"
                                  name="Менеджер" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[СвежийТовар]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[СвежийТовар]"
                                  name="СвежийТовар" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[СТМ]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[СТМ]"
                                  name="СТМ"
                                  precision="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код_Группы_Уровень_2]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код_Группы_Уровень_2]"
                                  name="Код_Группы_Уровень_2" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Имя_Группы_Уровень_2]"
                                  dataType="wstr"
                                  length="68"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Имя_Группы_Уровень_2]"
                                  name="Имя_Группы_Уровень_2" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код_Группы_Уровень_1]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код_Группы_Уровень_1]"
                                  name="Код_Группы_Уровень_1"
                                  precision="19" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Имя_Группы_Уровень_1]"
                                  dataType="wstr"
                                  length="68"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Имя_Группы_Уровень_1]"
                                  name="Имя_Группы_Уровень_1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[КодГлавныйДляАвтозаказа]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[КодГлавныйДляАвтозаказа]"
                                  name="КодГлавныйДляАвтозаказа" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[MarketClass_ID]"
                                  dataType="wstr"
                                  length="9"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[MarketClass_ID]"
                                  name="MarketClass_ID" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ПорогПродажДляРасчетаКоэффПродаж]"
                                  name="ПорогПродажДляРасчетаКоэффПродаж"
                                  precision="2" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                      </components>
                      <paths>
                        <path
                          refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС.Paths[ADO NET Source Output]"
                          endId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Inputs[Data Conversion Input]"
                          name="ADO NET Source Output"
                          startId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]" />
                        <path
                          refId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС.Paths[Data Conversion Output]"
                          endId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары.Inputs[ADO NET Destination Input]"
                          name="Data Conversion Output"
                          startId="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов.Outputs[Data Conversion Output]" />
                      </paths>
                    </pipeline>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:PrecedenceConstraints>
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Загрузка товаров.PrecedenceConstraints[Constraint]"
                  DTS:CreationName=""
                  DTS:DTSID="{77D72A47-7048-43E4-BF33-63B3780AB974}"
                  DTS:From="Package\КПТ\ОТБРС\Загрузка товаров\s8-oalp-test Очистка таблицы Товары"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint"
                  DTS:To="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС" />
              </DTS:PrecedenceConstraints>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\ОТБРС\Звгрузка поставщиков"
              DTS:CreationName="STOCK:SEQUENCE"
              DTS:Description="Контейнер последовательности"
              DTS:DTSID="{D657BD67-E03C-4BDE-A697-306E386E2B1D}"
              DTS:ExecutableType="STOCK:SEQUENCE"
              DTS:LocaleID="-1"
              DTS:ObjectName="Звгрузка поставщиков">
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\s8-oalp-test Очистка таблицы Поставщики_temp_load"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{19B2F882-9048-4024-A3F0-B67951EF1693}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="s8-oalp-test Очистка таблицы Поставщики_temp_load"
                  DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
                  DTS:ThreadHint="5">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                      SQLTask:TimeOut="30"
                      SQLTask:SqlStatementSource="truncate table [kpt].[t_fact_Поставщики_temp_load]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС"
                  DTS:CreationName="Microsoft.Pipeline"
                  DTS:Description="Data Flow Task"
                  DTS:DTSID="{0E15DD6A-F2AF-4A33-8C91-C430C8D43BB4}"
                  DTS:ExecutableType="Microsoft.Pipeline"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Загрузка поставщиков из ОТБРС"
                  DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <pipeline
                      BLOBTempStoragePath=""
                      bufferTempStoragePath=""
                      version="1">
                      <components>
                        <component
                          refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                          description="Writes to a database using ADO.NET provider."
                          name="s8-olap-test Поставщики_temp_load"
                          usesDispositions="true"
                          version="2">
                          <properties>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"kpt"."t_fact_Поставщики_temp_load"</property>
                            <property
                              dataType="System.Int32"
                              description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                              expressionType="Notify"
                              name="BatchSize">0</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                              expressionType="Notify"
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                              expressionType="Notify"
                              name="UseBulkInsertWhenPossible">true</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input]"
                              errorRowDisposition="FailComponent"
                              hasSideEffects="true"
                              name="ADO NET Destination Input">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].Columns[Код]"
                                  cachedDataType="wstr"
                                  cachedLength="6"
                                  cachedName="Код"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].Columns[Поставщик]"
                                  cachedDataType="wstr"
                                  cachedLength="40"
                                  cachedName="Поставщик"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Поставщик]"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Поставщик]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].Columns[ИДПоставщика]"
                                  cachedDataType="wstr"
                                  cachedLength="36"
                                  cachedName="ИДПоставщика"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ИДПоставщика]"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ИДПоставщика]" />
                              </inputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Код]"
                                  dataType="i8"
                                  name="Код" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[Поставщик]"
                                  dataType="wstr"
                                  length="100"
                                  name="Поставщик" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input].ExternalColumns[ИДПоставщика]"
                                  dataType="wstr"
                                  length="36"
                                  name="ИДПоставщика" />
                              </externalMetadataColumns>
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Outputs[ADO NET Destination Error Output]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="ADO NET Destination Error Output"
                              synchronousInputId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                          description="Extracts data from a relational database by using a .NET provider."
                          name="ОТБРС"
                          usesDispositions="true"
                          version="4">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Specifies the SQL statement used by the component to extract data."
                              expressionType="Notify"
                              name="SqlCommand"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">select
	Поставщики.code Код,
	Поставщики.descr Поставщик,
                Поставщики.SP4153 ИДПоставщика
from
	sc36 as Поставщики (nolock)
where
	Поставщики.parentid = '     4   '</property>
                            <property
                              dataType="System.Int32"
                              description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                              name="CommandTimeout">0</property>
                            <property
                              dataType="System.Boolean"
                              description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                              name="AllowImplicitStringConversion">true</property>
                            <property
                              dataType="System.String"
                              description="The Destination database table name."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                            <property
                              dataType="System.Int32"
                              description="Specify the mode to retrieve external column information"
                              name="AccessMode"
                              typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[serv-term.rozn.reader ADO .net]"
                              description="Managed connection manager"
                              name="IDbConnection" />
                          </connections>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]"
                              name="ADO NET Source Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код]"
                                  length="6"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Код]"
                                  name="Код"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Поставщик]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Поставщик]"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[Поставщик]"
                                  name="Поставщик"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ИДПоставщика]"
                                  dataType="wstr"
                                  errorOrTruncationOperation="Conversion"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ИДПоставщика]"
                                  length="36"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].Columns[ИДПоставщика]"
                                  name="ИДПоставщика"
                                  truncationRowDisposition="FailComponent" />
                              </outputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Код]"
                                  dataType="wstr"
                                  length="6"
                                  name="Код" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[Поставщик]"
                                  dataType="wstr"
                                  length="40"
                                  name="Поставщик" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output].ExternalColumns[ИДПоставщика]"
                                  dataType="wstr"
                                  length="36"
                                  name="ИДПоставщика" />
                              </externalMetadataColumns>
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output]"
                              isErrorOut="true"
                              name="ADO NET Source Error Output">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код]"
                                  dataType="wstr"
                                  length="6"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Код]"
                                  name="Код" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Поставщик]"
                                  dataType="wstr"
                                  length="40"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[Поставщик]"
                                  name="Поставщик" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ИДПоставщика]"
                                  dataType="wstr"
                                  length="36"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ИДПоставщика]"
                                  name="ИДПоставщика" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                      </components>
                      <paths>
                        <path
                          refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС.Paths[ADO NET Source Output]"
                          endId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load.Inputs[ADO NET Destination Input]"
                          name="ADO NET Source Output"
                          startId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС.Outputs[ADO NET Source Output]" />
                      </paths>
                    </pipeline>
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Звгрузка поставщиков\Слияние таблиц поставщики"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{EB8C0D70-8183-4DB5-B035-EC12C3C5DB7E}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Слияние таблиц поставщики"
                  DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
                  DTS:ThreadHint="5">
                  <DTS:Variables />
                  <DTS:LoggingOptions
                    DTS:FilterKind="0" />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                      SQLTask:SqlStatementSource="MERGE [kpt].[t_fact_Поставщики] AS Work&#xA;USING [kpt].[t_fact_Поставщики_temp_load] AS Temp&#xA;ON (Work.Код = Temp.Код)&#xA;WHEN NOT MATCHED BY TARGET&#xA;    THEN INSERT(Код, Поставщик, ИДПоставщика) VALUES(Temp.Код, Temp.Поставщик, Temp.ИДПоставщика)&#xA;WHEN MATCHED&#xA;    THEN UPDATE SET Work.Код = Temp.Код, Work.Поставщик = Temp.Поставщик, Work.ИДПоставщика = Temp.ИДПоставщика;&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:PrecedenceConstraints>
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Звгрузка поставщиков.PrecedenceConstraints[Constraint]"
                  DTS:CreationName=""
                  DTS:DTSID="{B25B1FFD-2287-4507-A8E5-704E7686AC21}"
                  DTS:From="Package\КПТ\ОТБРС\Звгрузка поставщиков\s8-oalp-test Очистка таблицы Поставщики_temp_load"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint"
                  DTS:To="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС" />
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Звгрузка поставщиков.PrecedenceConstraints[Constraint 1]"
                  DTS:CreationName=""
                  DTS:DTSID="{DBF61508-8EE2-4B9C-B906-335D519B2BE4}"
                  DTS:From="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint 1"
                  DTS:To="Package\КПТ\ОТБРС\Звгрузка поставщиков\Слияние таблиц поставщики" />
              </DTS:PrecedenceConstraints>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\ОТБРС\Контейнер последовательности"
              DTS:CreationName="STOCK:SEQUENCE"
              DTS:Description="Контейнер последовательности"
              DTS:DTSID="{0EC77115-0EDF-48AC-938C-D796505EBE0F}"
              DTS:ExecutableType="STOCK:SEQUENCE"
              DTS:LocaleID="-1"
              DTS:ObjectName="Контейнер последовательности">
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный"
                  DTS:CreationName="Microsoft.Pipeline"
                  DTS:Description="Задача потока данных"
                  DTS:DTSID="{3C268CAC-EBFE-4715-A1C5-64951F0732D8}"
                  DTS:ExecutableType="Microsoft.Pipeline"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Загрузка Остатков важный"
                  DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <pipeline
                      version="1">
                      <components>
                        <component
                          refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support4"
                          description="Потребляет данные из SQL Server, OLE DB, ODBC или Oracle с помощью соответствующего поставщика данных .NET. Используйте инструкцию Transact-SQL для определения результирующего набора. Пример: извлечение данных из SQL Server с помощью поставщика данных .NET Framework для SQL Server."
                          name="Источник - ADO NET"
                          usesDispositions="true"
                          version="4">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Задает инструкцию SQL, используемую компонентом для извлечения данных."
                              expressionType="Notify"
                              name="SqlCommand"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">set datefirst 7

declare @date as datetime
declare @dateN as datetime
declare @curdate as datetime
declare @Дата date;

set @curdate = convert(varchar(16), dateadd(day, -1, getdate()), 112)

set @date = CASE 
WHEN DATEPART(weekday, @curdate) = 1 THEN @curdate 
WHEN DATEPART(weekday, @curdate) = 2 THEN dateadd(day, + 6, @curdate) 
WHEN DATEPART(weekday, @curdate) = 3 THEN dateadd(day, + 5, @curdate) 
WHEN DATEPART(weekday, @curdate) = 4 THEN dateadd(day, + 4, @curdate) 
WHEN DATEPART(weekday, @curdate) = 5 THEN dateadd(day, + 3, @curdate) 
WHEN DATEPART(weekday, @curdate) = 6 THEN dateadd(day, + 2, @curdate) 
WHEN DATEPART(weekday, @curdate) = 7 THEN dateadd(day, + 1, @curdate)
END

set @dateN = dateadd(dd, -6, @date)

Select ost.Дата,ost.Час,ost.КодМагазина,vt.Основной_код_SNU КодТовара,sum(ost.КоличествоОстаток) КоличествоОстаток, sum(КоличествоПриход) КоличествоПриход
from dbo.t_fact_Остатки_по_часам ost (nolock)
join dbo.t_fact_Важный_товар vt on vt.ДатаНачала&lt;=ost.Дата and vt.ДатаКонца&gt;=ost.Дата and ost.КодМагазина=vt.КодМагазина and ost.КодТовара=vt.КодТовара
where Дата between @dateN and @date
group by ost.Дата,ost.Час,ost.КодМагазина,vt.Основной_код_SNU</property>
                            <property
                              dataType="System.Int32"
                              description="Время ожидания команды, в секундах. Значение 0 означает неограниченное время ожидания."
                              name="CommandTimeout">30</property>
                            <property
                              dataType="System.Boolean"
                              description="Указывает, будут ли внешние столбцы с типом, отличным от строкового, в выходных столбцах неявно преобразовываться в строки."
                              name="AllowImplicitStringConversion">true</property>
                            <property
                              dataType="System.String"
                              description="Имя таблицы базы данных-источника."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                            <property
                              dataType="System.Int32"
                              description="Укажите режим получения данных о внешних столбцах"
                              name="AccessMode"
                              typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Диспетчер управляемых соединений"
                              name="IDbConnection" />
                          </connections>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET]"
                              name="Вывод источника ADO NET">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[Дата]"
                                  dataType="dbDate"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[Дата]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[Дата]"
                                  name="Дата"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[Час]"
                                  dataType="i4"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[Час]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[Час]"
                                  name="Час"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КодМагазина]"
                                  dataType="i4"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КодМагазина]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КодМагазина]"
                                  name="КодМагазина"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                                  dataType="i8"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КодТовара]"
                                  name="КодТовара"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КоличествоОстаток]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КоличествоОстаток]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КоличествоОстаток]"
                                  name="КоличествоОстаток"
                                  precision="38"
                                  scale="3"
                                  truncationRowDisposition="FailComponent" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КоличествоПриход]"
                                  dataType="numeric"
                                  errorOrTruncationOperation="Преобразование"
                                  errorRowDisposition="FailComponent"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КоличествоПриход]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КоличествоПриход]"
                                  name="КоличествоПриход"
                                  precision="38"
                                  scale="3"
                                  truncationRowDisposition="FailComponent" />
                              </outputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[Дата]"
                                  dataType="dbDate"
                                  name="Дата" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[Час]"
                                  dataType="i4"
                                  name="Час" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КодМагазина]"
                                  dataType="i4"
                                  name="КодМагазина" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КодТовара]"
                                  dataType="i8"
                                  name="КодТовара" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КоличествоОстаток]"
                                  dataType="numeric"
                                  name="КоличествоОстаток"
                                  precision="38"
                                  scale="3" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].ExternalColumns[КоличествоПриход]"
                                  dataType="numeric"
                                  name="КоличествоПриход"
                                  precision="38"
                                  scale="3" />
                              </externalMetadataColumns>
                            </output>
                            <output
                              refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET]"
                              isErrorOut="true"
                              name="Вывод ошибок источника ADO NET">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[Дата]"
                                  dataType="dbDate"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[Дата]"
                                  name="Дата" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[Час]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[Час]"
                                  name="Час" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КодМагазина]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КодМагазина]"
                                  name="КодМагазина" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                                  dataType="i8"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КодТовара]"
                                  name="КодТовара" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КоличествоОстаток]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КоличествоОстаток]"
                                  name="КоличествоОстаток"
                                  precision="38"
                                  scale="3" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КоличествоПриход]"
                                  dataType="numeric"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[КоличествоПриход]"
                                  name="КоличествоПриход"
                                  precision="38"
                                  scale="3" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод ошибок источника ADO NET].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                        <component
                          refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET"
                          componentClassID="Microsoft.ManagedComponentHost"
                          contactInfo="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC.Корпорация Майкрософт (Microsoft Corporation). Microsoft SQL Server © Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support2"
                          description="Загружает данные в базы данных, поддерживающие ADO.NET, в которых используются таблицы или представления. Загружает данные в новую или существующую таблицу. Пример: использование поставщика ADO.NET для ODBC, чтобы загрузить данные в назначение ODBC."
                          name="Назначение ADO NET"
                          usesDispositions="true"
                          version="2">
                          <properties>
                            <property
                              dataType="System.String"
                              description="Имя таблицы в целевой базе данных."
                              expressionType="Notify"
                              name="TableOrViewName"
                              UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."t_temp_Остатки_по_часам_ВТ"</property>
                            <property
                              dataType="System.Int32"
                              description="Укажите число строк в пакете. Значение по умолчанию - 0, при котором размер совпадает с внутренним буфером служб SSIS. "
                              expressionType="Notify"
                              name="BatchSize">0</property>
                            <property
                              dataType="System.Int32"
                              description="Время ожидания для выполнения команды (в секундах). Значение 0 указывает на бесконечное время работы. "
                              expressionType="Notify"
                              name="CommandTimeout">30</property>
                            <property
                              dataType="System.Boolean"
                              description="Указывает, нужно ли использовать интерфейс SqlBulkCopy для повышения производительности операций массовой вставки. Этот интерфейс поддерживается не всеми поставщиками."
                              expressionType="Notify"
                              name="UseBulkInsertWhenPossible">true</property>
                            <property
                              dataType="System.String"
                              name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                          </properties>
                          <connections>
                            <connection
                              refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Connections[IDbConnection]"
                              connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                              description="Диспетчер управляемых соединений"
                              name="IDbConnection" />
                          </connections>
                          <inputs>
                            <input
                              refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET]"
                              errorRowDisposition="FailComponent"
                              hasSideEffects="true"
                              name="Вход назначения ADO NET">
                              <inputColumns>
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].Columns[Дата]"
                                  cachedDataType="dbDate"
                                  cachedName="Дата"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[Дата]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[Дата]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].Columns[Час]"
                                  cachedDataType="i4"
                                  cachedName="Час"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[Час]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[Час]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].Columns[КодМагазина]"
                                  cachedDataType="i4"
                                  cachedName="КодМагазина"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КодМагазина]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КодМагазина]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].Columns[КодТовара]"
                                  cachedDataType="i8"
                                  cachedName="КодТовара"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КодТовара]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].Columns[КоличествоОстаток]"
                                  cachedDataType="numeric"
                                  cachedName="КоличествоОстаток"
                                  cachedPrecision="38"
                                  cachedScale="3"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КоличествоОстаток]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КоличествоОстаток]" />
                                <inputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].Columns[КоличествоПриход]"
                                  cachedDataType="numeric"
                                  cachedName="КоличествоПриход"
                                  cachedPrecision="38"
                                  cachedScale="3"
                                  externalMetadataColumnId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КоличествоПриход]"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET].Columns[КоличествоПриход]" />
                              </inputColumns>
                              <externalMetadataColumns
                                isUsed="True">
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[Дата]"
                                  dataType="dbTimeStamp"
                                  name="Дата" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КодМагазина]"
                                  dataType="i4"
                                  name="КодМагазина" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[Час]"
                                  dataType="i4"
                                  name="Час" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КодТовара]"
                                  dataType="i8"
                                  name="КодТовара" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КоличествоОстаток]"
                                  dataType="numeric"
                                  name="КоличествоОстаток"
                                  precision="12"
                                  scale="3" />
                                <externalMetadataColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET].ExternalColumns[КоличествоПриход]"
                                  dataType="numeric"
                                  name="КоличествоПриход"
                                  precision="12"
                                  scale="3" />
                              </externalMetadataColumns>
                            </input>
                          </inputs>
                          <outputs>
                            <output
                              refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Outputs[Вывод ошибок назначения ADO NET]"
                              exclusionGroup="1"
                              isErrorOut="true"
                              name="Вывод ошибок назначения ADO NET"
                              synchronousInputId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET]">
                              <outputColumns>
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorCode]"
                                  name="ErrorCode"
                                  specialFlags="1" />
                                <outputColumn
                                  refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                                  dataType="i4"
                                  lineageId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Outputs[Вывод ошибок назначения ADO NET].Columns[ErrorColumn]"
                                  name="ErrorColumn"
                                  specialFlags="2" />
                              </outputColumns>
                              <externalMetadataColumns />
                            </output>
                          </outputs>
                        </component>
                      </components>
                      <paths>
                        <path
                          refId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный.Paths[Вывод источника ADO NET]"
                          endId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET.Inputs[Вход назначения ADO NET]"
                          name="Вывод источника ADO NET"
                          startId="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET.Outputs[Вывод источника ADO NET]" />
                      </paths>
                    </pipeline>
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\КПТ\ОТБРС\Контейнер последовательности\Очистка остатков от шляпы"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Задача &quot;Выполнение SQL&quot;"
                  DTS:DTSID="{C6937F95-D965-475C-A8F4-EEE458764E9D}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Очистка остатков от шляпы"
                  DTS:ThreadHint="6">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{0A9C0910-30E2-4287-9B51-ABD08498C0E8}"
                      SQLTask:SqlStatementSource="set datefirst 7&#xA;&#xA;declare @date as datetime&#xA;declare @dateN as datetime&#xA;declare @curdate as datetime&#xA;&#xA;set @curdate=convert(varchar(16), dateadd(day, -1, getdate()), 112)&#xA;&#xA;set @date =CASE &#xA;WHEN DATEPART(weekday, @curdate) = 1 THEN @curdate &#xA;WHEN DATEPART(weekday, @curdate) = 2 THEN dateadd(day, + 6, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 3 THEN dateadd(day, + 5, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 4 THEN dateadd(day, + 4, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 5 THEN dateadd(day, + 3, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 6 THEN dateadd(day, + 2, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 7 THEN dateadd(day, + 1, @curdate)&#xA;END&#xA;set @dateN = dateadd(dd, -6, @date)&#xA;&#xA;delete ost from t_fact_Остатки_по_часам as ost&#xA;join (select дата,час,кодмагазина from t_fact_Остатки_по_часам where Дата between @dateN and @date&#x9;group by Дата,час,КодМагазина&#xA;&#x9;having  sum (КоличествоОстаток)=0) as del on ost.Дата=del.Дата and ost.час=del.Час and ost.КодМагазина=del.КодМагазина&#xA;&#x9;&#xA;truncate table [dbo].[t_temp_Остатки_по_часам_ВТ]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:PrecedenceConstraints>
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\КПТ\ОТБРС\Контейнер последовательности.PrecedenceConstraints[Constraint]"
                  DTS:CreationName=""
                  DTS:DTSID="{D8950173-1908-42E2-A2B3-6767ABBAC457}"
                  DTS:From="Package\КПТ\ОТБРС\Контейнер последовательности\Очистка остатков от шляпы"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Constraint"
                  DTS:To="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный" />
              </DTS:PrecedenceConstraints>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\КПТ\Формирование КПТ Онлайн"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{018CCAB9-2C82-49B9-A7E4-88F91FCD788F}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Формирование КПТ Онлайн">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Data Flow Task"
              DTS:DTSID="{1D167DFF-2AE4-455C-9432-9E17B8A90091}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Свод_ступень_обработки_1"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:LoggingOptions
                DTS:FilterKind="0" />
              <DTS:ObjectData>
                <pipeline
                  BLOBTempStoragePath=""
                  bufferTempStoragePath=""
                  version="1">
                  <components>
                    <component
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Extracts data from a relational database by using a .NET provider."
                      name="Все источники"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">--Неделя отчета
                  set datefirst 7
declare @dateBegin as datetime
declare @dateEnd as datetime
declare @curdate as datetime
set @curdate=convert(varchar(16), dateadd(day, -1, getdate()), 112)
set @dateEnd =CASE 
WHEN DATEPART(weekday, @curdate) = 1 THEN @curdate 
WHEN DATEPART(weekday, @curdate) = 2 THEN dateadd(day, + 6, @curdate) 
WHEN DATEPART(weekday, @curdate) = 3 THEN dateadd(day, + 5, @curdate) 
WHEN DATEPART(weekday, @curdate) = 4 THEN dateadd(day, + 4, @curdate) 
WHEN DATEPART(weekday, @curdate) = 5 THEN dateadd(day, + 3, @curdate) 
WHEN DATEPART(weekday, @curdate) = 6 THEN dateadd(day, + 2, @curdate) 
WHEN DATEPART(weekday, @curdate) = 7 THEN dateadd(day, + 1, @curdate)
END
set @dateBegin = dateadd(dd, -6, @dateEnd)

--Запрос
select
	ОТБРС_Матрица.Дата,
cast(ОстаткиЧАС.Час as tinyint) Час,
	ОТБРС_Матрица.КодТовара,    
	ОТБРС_Матрица.КодПоставщика,
	ОТБРС_Матрица.КодМагазина,
                ОТБРС_Матрица.ВидАсс,
                ОТБРС_Матрица.ВидАсс14денейНазад,
	ОТБРС_Матрица.ТОП,
                ОТБРС_Матрица.ВидПоставки,
	ОстаткиЧАС.КоличествоОстаток,
ОстаткиЧАС.КоличествоПриход,
	OLAP_ПродажиЗаПериод.Количество ПродажиШТ,
	OLAP_ПродажиЗаПериод.Сумма ПродажиРуб,

--vvvvvvvvvvvvvvvv--КПТ по остаткам--vvvvvvvvvvvvvvvv--
case when ОТБРС_Матрица.КодТовара not  in 
(select Товары.код Код
	from
	dbo.Товары as Товары (nolock)
left join
	dbo.Товары as ПодГруппы (nolock)
		on Товары.родитель = подГруппы.код
left join
	dbo.Товары as Группы (nolock)
on подгруппы.родитель = Группы.код		
	where товары.код in (select Список.КодГруппы from СписокГруппСобственногоПроизводства Список (nolock)) or
	подгруппы.код in (select Список.КодГруппы from СписокГруппСобственногоПроизводства Список (nolock)) or
	группы.код in (select Список.КодГруппы from СписокГруппСобственногоПроизводства Список (nolock)))
	
then
cast(case
		when (ОстаткиЧАС.КоличествоОстаток+ОстаткиЧАС.КоличествоПриход-coalesce(OLAP_ПродажиЗаПериод.Количество,0 )) &gt; 0 then 1 else 0 end
 as decimal(10,2))
 else NULL end  КПТ
------------------------------------------------	



from
	[kpt].[t_fact_ОТБРС_Матрица]  as ОТБРС_Матрица (nolock)


inner join
	t_fact_Остатки_по_часам ОстаткиЧАС (nolock)
		on ОстаткиЧАС .Дата = ОТБРС_Матрица.Дата
		and ОстаткиЧАС .КодТовара = ОТБРС_Матрица.КодТовара
		and ОстаткиЧАС .КодМагазина = ОТБРС_Матрица.КодМагазина

left  join
	(select
		OLAP_Продажи.ДатаПродажи,
OLAP_Продажи.ЧасПродажи,
		OLAP_Продажи.КодТовара,
		OLAP_Продажи.КодМагазина,
		sum(OLAP_Продажи.Количество) Количество,
		sum(OLAP_Продажи.Сумма) Сумма
	from t_fact_Продажи_по_Часам OLAP_Продажи (nolock)
	group by
		OLAP_Продажи.ДатаПродажи,
OLAP_Продажи.ЧасПродажи,
		OLAP_Продажи.КодТовара,
		OLAP_Продажи.КодМагазина
	) OLAP_ПродажиЗаПериод
		on OLAP_ПродажиЗаПериод.ДатаПродажи = ОТБРС_Матрица.Дата
		and OLAP_ПродажиЗаПериод.КодТовара = ОТБРС_Матрица.КодТовара
		and OLAP_ПродажиЗаПериод.КодМагазина = ОТБРС_Матрица.КодМагазина
and OLAP_продажизапериод.часпродажи=ОстаткиЧас.час

left join
	[kpt].[t_fact_Магазины] as магазины (nolock) on Магазины.Код = ОТБРС_Матрица.КодМагазина

left join
	[kpt].[t_fact_Товары] as спрТовары  (nolock) ON спрТовары.Код=ОТБРС_Матрица.КодТовара


WHERE
-- отсеиваем следующие магазины:
 Магазины.Код NOT IN (
						SELECT 
								МагазиныНаРеконструкции.[Код]
   
						FROM [kpt].[t_fact_Магазины] МагазиныНаРеконструкции (nolock)
						WHERE ОТБРС_Матрица.Дата&lt;МагазиныНаРеконструкции.[ДатаОткрытия] OR (МагазиныНаРеконструкции.[ДатаОткрытия]&lt;'1900-01-01') --Товар в матрице, но магазин еще не открыт
						or (ОТБРС_Матрица.Дата&gt;=МагазиныНаРеконструкции.[ДатаНачалаРеконструкции] and ОТБРС_Матрица.Дата&lt;=МагазиныНаРеконструкции.[ДатаКонцаРеконструкции]) --Товар в матрице, но магазин еще на реконструкции
						
						)</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Дата]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Дата]"
                              name="Дата"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Час]"
                              dataType="ui1"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Час]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Час]"
                              name="Час"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодТовара]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодТовара]"
                              name="КодТовара"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                              name="КодПоставщика"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                              name="КодМагазина"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                              dataType="ui1"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                              name="ВидАсс"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс14денейНазад]"
                              dataType="ui1"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс14денейНазад]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс14денейНазад]"
                              name="ВидАсс14денейНазад"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ТОП]"
                              dataType="bool"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ТОП]"
                              name="ТОП"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                              dataType="bool"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                              name="ВидПоставки"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоОстаток]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоОстаток]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоОстаток]"
                              name="КоличествоОстаток"
                              precision="12"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоПриход]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоПриход]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоПриход]"
                              name="КоличествоПриход"
                              precision="12"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиШТ]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиШТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиШТ]"
                              name="ПродажиШТ"
                              precision="38"
                              scale="5"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиРуб]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиРуб]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиРуб]"
                              name="ПродажиРуб"
                              precision="38"
                              scale="5"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КПТ]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КПТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КПТ]"
                              name="КПТ"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                              dataType="dbDate"
                              name="Дата" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Час]"
                              dataType="ui1"
                              name="Час" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                              dataType="i8"
                              name="КодПоставщика" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                              dataType="i8"
                              name="КодМагазина" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                              dataType="ui1"
                              name="ВидАсс" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс14денейНазад]"
                              dataType="ui1"
                              name="ВидАсс14денейНазад" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                              dataType="bool"
                              name="ТОП" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                              dataType="bool"
                              name="ВидПоставки" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоОстаток]"
                              dataType="numeric"
                              name="КоличествоОстаток"
                              precision="12"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоПриход]"
                              dataType="numeric"
                              name="КоличествоПриход"
                              precision="12"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиШТ]"
                              dataType="numeric"
                              name="ПродажиШТ"
                              precision="38"
                              scale="5" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиРуб]"
                              dataType="numeric"
                              name="ПродажиРуб"
                              precision="38"
                              scale="5" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КПТ]"
                              dataType="numeric"
                              name="КПТ"
                              precision="10"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[Дата]"
                              dataType="dbDate"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[Дата]"
                              name="Дата" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[Час]"
                              dataType="ui1"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[Час]"
                              name="Час" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                              dataType="i8"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                              name="КодТовара" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                              dataType="i8"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                              name="КодПоставщика" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                              dataType="i8"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                              name="КодМагазина" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                              dataType="ui1"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                              name="ВидАсс" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс14денейНазад]"
                              dataType="ui1"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс14денейНазад]"
                              name="ВидАсс14денейНазад" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                              dataType="bool"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                              name="ТОП" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                              dataType="bool"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                              name="ВидПоставки" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоОстаток]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоОстаток]"
                              name="КоличествоОстаток"
                              precision="12"
                              scale="3" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоПриход]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоПриход]"
                              name="КоличествоПриход"
                              precision="12"
                              scale="3" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиШТ]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиШТ]"
                              name="ПродажиШТ"
                              precision="38"
                              scale="5" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиРуб]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиРуб]"
                              name="ПродажиРуб"
                              precision="38"
                              scale="5" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КПТ]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[КПТ]"
                              name="КПТ"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов"
                      componentClassID="Microsoft.DataConvert"
                      contactInfo="Data Conversion;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
                      description="Data Conversion"
                      name="Преобразование типов"
                      usesDispositions="true">
                      <inputs>
                        <input
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Inputs[Data Conversion Input]"
                          name="Data Conversion Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Inputs[Data Conversion Input].Columns[ВидПоставки]"
                              cachedDataType="bool"
                              cachedName="ВидПоставки"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Inputs[Data Conversion Input].Columns[Час]"
                              cachedDataType="ui1"
                              cachedName="Час"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Час]" />
                          </inputColumns>
                          <externalMetadataColumns />
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Output]"
                          exclusionGroup="1"
                          name="Data Conversion Output"
                          synchronousInputId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Inputs[Data Conversion Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of ВидПоставки]"
                              dataType="i2"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of ВидПоставки]"
                              name="Copy of ВидПоставки"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.Int32"
                                  description="Specifies the input column used as the source of data for the conversion."
                                  name="SourceInputColumnLineageID">#{Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]}</property>
                                <property
                                  dataType="System.Boolean"
                                  description="Indicates whether the column uses the faster, locale-neutral parsing routines."
                                  name="FastParse">false</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of Час]"
                              dataType="i2"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of Час]"
                              name="Copy of Час"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.Int32"
                                  description="Указывает входной столбец, служащий источником данных для преобразования."
                                  name="SourceInputColumnLineageID">#{Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Час]}</property>
                                <property
                                  dataType="System.Boolean"
                                  description="Указывает, используются ли в столбце более производительные, не зависящие от локалей процедуры синтаксического анализа."
                                  name="FastParse">false</property>
                              </properties>
                            </outputColumn>
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Data Conversion Error Output"
                          synchronousInputId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Inputs[Data Conversion Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                      description="Writes to a database using ADO.NET provider."
                      name="Свод_ступень_обработки_1"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."t_fact_КПТ_по_часам"</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[Дата]"
                              cachedDataType="dbDate"
                              cachedName="Дата"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Дата]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КодТовара]"
                              cachedDataType="i8"
                              cachedName="КодТовара"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодТовара]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КодПоставщика]"
                              cachedDataType="i8"
                              cachedName="КодПоставщика"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодПоставщика]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КодМагазина]"
                              cachedDataType="i8"
                              cachedName="КодМагазина"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КодМагазина]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ВидАсс]"
                              cachedDataType="ui1"
                              cachedName="ВидАсс"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ТОП]"
                              cachedDataType="bool"
                              cachedName="ТОП"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ТОП]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КоличествоОстаток]"
                              cachedDataType="numeric"
                              cachedName="КоличествоОстаток"
                              cachedPrecision="12"
                              cachedScale="3"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоОстаток]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоОстаток]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КоличествоПриход]"
                              cachedDataType="numeric"
                              cachedName="КоличествоПриход"
                              cachedPrecision="12"
                              cachedScale="3"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоПриход]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоПриход]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ПродажиШТ]"
                              cachedDataType="numeric"
                              cachedName="ПродажиШТ"
                              cachedPrecision="38"
                              cachedScale="5"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиШТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиШТ]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ПродажиРуб]"
                              cachedDataType="numeric"
                              cachedName="ПродажиРуб"
                              cachedPrecision="38"
                              cachedScale="5"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиРуб]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиРуб]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КПТ]"
                              cachedDataType="numeric"
                              cachedName="КПТ"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КПТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[КПТ]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ВидАсс14денейНазад]"
                              cachedDataType="ui1"
                              cachedName="ВидАсс14денейНазад"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс14днейНазад]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс14денейНазад]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[Copy of ВидПоставки]"
                              cachedDataType="i2"
                              cachedName="Copy of ВидПоставки"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of ВидПоставки]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[Час]"
                              cachedDataType="ui1"
                              cachedName="Час"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Час]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output].Columns[Час]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                              dataType="dbTimeStamp"
                              name="Дата" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Час]"
                              dataType="ui1"
                              name="Час" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                              dataType="i8"
                              name="КодПоставщика" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                              dataType="i8"
                              name="КодМагазина" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                              dataType="bool"
                              name="ТОП" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоПриход]"
                              dataType="numeric"
                              name="КоличествоПриход"
                              precision="18"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоОстаток]"
                              dataType="numeric"
                              name="КоличествоОстаток"
                              precision="18"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиШТ]"
                              dataType="numeric"
                              name="ПродажиШТ"
                              precision="18"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиРуб]"
                              dataType="numeric"
                              name="ПродажиРуб"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                              dataType="ui1"
                              name="ВидАсс" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс14днейНазад]"
                              dataType="ui1"
                              name="ВидАсс14днейНазад" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                              dataType="i2"
                              name="ВидПоставки" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КПТ]"
                              dataType="ui1"
                              name="КПТ" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1.Paths[ADO NET Source Output]"
                      endId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Inputs[Data Conversion Input]"
                      name="ADO NET Source Output"
                      startId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники.Outputs[ADO NET Source Output]" />
                    <path
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1.Paths[Data Conversion Output]"
                      endId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input]"
                      name="Data Conversion Output"
                      startId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов.Outputs[Data Conversion Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Data Flow Task"
              DTS:DTSID="{ed12a039-1fca-4792-9779-a8844503b09c}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Свод_ступень_обработки_2"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:LoggingOptions
                DTS:FilterKind="0" />
              <DTS:ObjectData>
                <pipeline
                  BLOBTempStoragePath=""
                  bufferTempStoragePath=""
                  version="1">
                  <components>
                    <component
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Extracts data from a relational database by using a .NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Extracts data from a relational database by using a .NET provider."
                      name="Все источники"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">--Неделя отчета
                  set datefirst 7
declare @dateBegin as datetime
declare @dateEnd as datetime
declare @curdate as datetime
set @curdate=convert(varchar(16), dateadd(day, -1, getdate()), 112)
set @dateEnd =CASE 
WHEN DATEPART(weekday, @curdate) = 1 THEN @curdate 
WHEN DATEPART(weekday, @curdate) = 2 THEN dateadd(day, + 6, @curdate) 
WHEN DATEPART(weekday, @curdate) = 3 THEN dateadd(day, + 5, @curdate) 
WHEN DATEPART(weekday, @curdate) = 4 THEN dateadd(day, + 4, @curdate) 
WHEN DATEPART(weekday, @curdate) = 5 THEN dateadd(day, + 3, @curdate) 
WHEN DATEPART(weekday, @curdate) = 6 THEN dateadd(day, + 2, @curdate) 
WHEN DATEPART(weekday, @curdate) = 7 THEN dateadd(day, + 1, @curdate)
END
set @dateBegin = dateadd(dd, -6, @dateEnd)

--Запрос
select
	ОТБРС_Матрица.Дата,
cast(ОстаткиЧАС.Час as tinyint) Час,
	ОТБРС_Матрица.КодТовара,    
	ОТБРС_Матрица.КодПоставщика,
	ОТБРС_Матрица.КодМагазина,
                ОТБРС_Матрица.ВидАсс,
                ОТБРС_Матрица.ВидАсс14денейНазад,
	ОТБРС_Матрица.ТОП,
                ОТБРС_Матрица.ВидПоставки,
	ОстаткиЧАС.КоличествоОстаток,
ОстаткиЧАС.КоличествоПриход,
	OLAP_ПродажиЗаПериод.Количество ПродажиШТ,
	OLAP_ПродажиЗаПериод.Сумма ПродажиРуб,

--vvvvvvvvvvvvvvvv--КПТ по остаткам--vvvvvvvvvvvvvvvv--
case when ОТБРС_Матрица.КодТовара not  in 
(select Товары.код Код
	from
	dbo.Товары as Товары (nolock)
left join
	dbo.Товары as ПодГруппы (nolock)
		on Товары.родитель = подГруппы.код
left join
	dbo.Товары as Группы (nolock)
on подгруппы.родитель = Группы.код		
	where товары.код in (select Список.КодГруппы from СписокГруппСобственногоПроизводства Список (nolock)) or
	подгруппы.код in (select Список.КодГруппы from СписокГруппСобственногоПроизводства Список (nolock)) or
	группы.код in (select Список.КодГруппы from СписокГруппСобственногоПроизводства Список (nolock)))
	
then
cast(case
		when (ОстаткиЧАС.КоличествоОстаток+ОстаткиЧАС.КоличествоПриход-coalesce(OLAP_ПродажиЗаПериод.Количество,0 )) &gt; 0 then 1 else 0 end
 as decimal(10,2))
 else NULL end  КПТ
------------------------------------------------	



from
	[kpt].[t_fact_ОТБРС_Матрица] as ОТБРС_матрица (nolock)


inner join
	t_temp_Остатки_по_часам_ВТ ОстаткиЧАС (nolock)
		on ОстаткиЧАС .Дата = ОТБРС_Матрица.Дата
		and ОстаткиЧАС .КодТовара = ОТБРС_Матрица.КодТовара
		and ОстаткиЧАС .КодМагазина = ОТБРС_Матрица.КодМагазина

left join
	(select
		OLAP_Продажи.ДатаПродажи,
OLAP_Продажи.ЧасПродажи,
		OLAP_Продажи.КодТовара,
		OLAP_Продажи.КодМагазина,
		sum(OLAP_Продажи.Количество) Количество,
		sum(OLAP_Продажи.Сумма) Сумма
	from t_fact_Продажи_по_Часам OLAP_Продажи (nolock)
	group by
		OLAP_Продажи.ДатаПродажи,
OLAP_Продажи.ЧасПродажи,
		OLAP_Продажи.КодТовара,
		OLAP_Продажи.КодМагазина
	) OLAP_ПродажиЗаПериод
		on OLAP_ПродажиЗаПериод.ДатаПродажи = ОТБРС_Матрица.Дата
		and OLAP_ПродажиЗаПериод.КодТовара = ОТБРС_Матрица.КодТовара
		and OLAP_ПродажиЗаПериод.КодМагазина = ОТБРС_Матрица.КодМагазина
and OLAP_продажизапериод.часпродажи=ОстаткиЧас.час

left join
	[kpt].[t_fact_Магазины] as Магазины (nolock) on Магазины.Код = ОТБРС_Матрица.КодМагазина

left join
	[kpt].[t_fact_Товары] as спрТовары  (nolock) ON спрТовары.Код=ОТБРС_Матрица.КодТовара


WHERE
-- отсеиваем следующие магазины:
 Магазины.Код NOT IN (
						SELECT 
								МагазиныНаРеконструкции.[Код]
   
						FROM [Магазины] МагазиныНаРеконструкции (nolock)
						WHERE ОТБРС_Матрица.Дата&lt;МагазиныНаРеконструкции.[ДатаОткрытия] OR (МагазиныНаРеконструкции.[ДатаОткрытия]&lt;'1900-01-01') --Товар в матрице, но магазин еще не открыт
						or (ОТБРС_Матрица.Дата&gt;=МагазиныНаРеконструкции.[ДатаНачалаРеконструкции] and ОТБРС_Матрица.Дата&lt;=МагазиныНаРеконструкции.[ДатаКонцаРеконструкции]) --Товар в матрице, но магазин еще на реконструкции
						
						)</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Дата]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Дата]"
                              name="Дата"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Час]"
                              dataType="ui1"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Час]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Час]"
                              name="Час"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодТовара]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодТовара]"
                              name="КодТовара"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодПоставщика]"
                              name="КодПоставщика"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                              dataType="i8"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодМагазина]"
                              name="КодМагазина"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                              dataType="ui1"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс]"
                              name="ВидАсс"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс14денейНазад]"
                              dataType="ui1"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс14денейНазад]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс14денейНазад]"
                              name="ВидАсс14денейНазад"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ТОП]"
                              dataType="bool"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ТОП]"
                              name="ТОП"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                              dataType="bool"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]"
                              name="ВидПоставки"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоОстаток]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоОстаток]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоОстаток]"
                              name="КоличествоОстаток"
                              precision="12"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоПриход]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоПриход]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоПриход]"
                              name="КоличествоПриход"
                              precision="12"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиШТ]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиШТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиШТ]"
                              name="ПродажиШТ"
                              precision="38"
                              scale="5"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиРуб]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиРуб]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиРуб]"
                              name="ПродажиРуб"
                              precision="38"
                              scale="5"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КПТ]"
                              dataType="numeric"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КПТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КПТ]"
                              name="КПТ"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Дата]"
                              dataType="dbDate"
                              name="Дата" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[Час]"
                              dataType="ui1"
                              name="Час" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодПоставщика]"
                              dataType="i8"
                              name="КодПоставщика" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КодМагазина]"
                              dataType="i8"
                              name="КодМагазина" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс]"
                              dataType="ui1"
                              name="ВидАсс" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидАсс14денейНазад]"
                              dataType="ui1"
                              name="ВидАсс14денейНазад" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ТОП]"
                              dataType="bool"
                              name="ТОП" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ВидПоставки]"
                              dataType="bool"
                              name="ВидПоставки" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоОстаток]"
                              dataType="numeric"
                              name="КоличествоОстаток"
                              precision="12"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КоличествоПриход]"
                              dataType="numeric"
                              name="КоличествоПриход"
                              precision="12"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиШТ]"
                              dataType="numeric"
                              name="ПродажиШТ"
                              precision="38"
                              scale="5" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[ПродажиРуб]"
                              dataType="numeric"
                              name="ПродажиРуб"
                              precision="38"
                              scale="5" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].ExternalColumns[КПТ]"
                              dataType="numeric"
                              name="КПТ"
                              precision="10"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[Дата]"
                              dataType="dbDate"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[Дата]"
                              name="Дата" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[Час]"
                              dataType="ui1"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[Час]"
                              name="Час" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                              dataType="i8"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КодТовара]"
                              name="КодТовара" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                              dataType="i8"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КодПоставщика]"
                              name="КодПоставщика" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                              dataType="i8"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КодМагазина]"
                              name="КодМагазина" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                              dataType="ui1"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс]"
                              name="ВидАсс" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс14денейНазад]"
                              dataType="ui1"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидАсс14денейНазад]"
                              name="ВидАсс14денейНазад" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                              dataType="bool"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ТОП]"
                              name="ТОП" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                              dataType="bool"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ВидПоставки]"
                              name="ВидПоставки" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоОстаток]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоОстаток]"
                              name="КоличествоОстаток"
                              precision="12"
                              scale="3" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоПриход]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КоличествоПриход]"
                              name="КоличествоПриход"
                              precision="12"
                              scale="3" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиШТ]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиШТ]"
                              name="ПродажиШТ"
                              precision="38"
                              scale="5" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиРуб]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ПродажиРуб]"
                              name="ПродажиРуб"
                              precision="38"
                              scale="5" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КПТ]"
                              dataType="numeric"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[КПТ]"
                              name="КПТ"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов"
                      componentClassID="Microsoft.DataConvert"
                      contactInfo="Data Conversion;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
                      description="Data Conversion"
                      name="Преобразование типов"
                      usesDispositions="true">
                      <inputs>
                        <input
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Inputs[Data Conversion Input]"
                          name="Data Conversion Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Inputs[Data Conversion Input].Columns[ВидПоставки]"
                              cachedDataType="bool"
                              cachedName="ВидПоставки"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Inputs[Data Conversion Input].Columns[Час]"
                              cachedDataType="ui1"
                              cachedName="Час"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Час]" />
                          </inputColumns>
                          <externalMetadataColumns />
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Output]"
                          exclusionGroup="1"
                          name="Data Conversion Output"
                          synchronousInputId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Inputs[Data Conversion Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of ВидПоставки]"
                              dataType="i2"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of ВидПоставки]"
                              name="Copy of ВидПоставки"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.Int32"
                                  description="Specifies the input column used as the source of data for the conversion."
                                  name="SourceInputColumnLineageID">#{Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидПоставки]}</property>
                                <property
                                  dataType="System.Boolean"
                                  description="Indicates whether the column uses the faster, locale-neutral parsing routines."
                                  name="FastParse">false</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of Час]"
                              dataType="i2"
                              errorOrTruncationOperation="Преобразование"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of Час]"
                              name="Copy of Час"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.Int32"
                                  description="Указывает входной столбец, служащий источником данных для преобразования."
                                  name="SourceInputColumnLineageID">#{Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Час]}</property>
                                <property
                                  dataType="System.Boolean"
                                  description="Указывает, используются ли в столбце более производительные, не зависящие от локалей процедуры синтаксического анализа."
                                  name="FastParse">false</property>
                              </properties>
                            </outputColumn>
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Data Conversion Error Output"
                          synchronousInputId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Inputs[Data Conversion Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Writes to a database using ADO.NET provider.;Microsoft Corporation; Microsoft SqlServer v10; © 2007 Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                      description="Writes to a database using ADO.NET provider."
                      name="Свод_ступень_обработки_1"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."t_fact_КПТ_по_часам_ВТ"</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Connections[IDbConnection]"
                          connectionManagerID="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          connectionManagerRefId="Package.ConnectionManagers[s19-olap.KPT.reader ADO .net]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[Дата]"
                              cachedDataType="dbDate"
                              cachedName="Дата"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Дата]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[Час]"
                              cachedDataType="ui1"
                              cachedName="Час"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Час]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[Час]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КодТовара]"
                              cachedDataType="i8"
                              cachedName="КодТовара"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодТовара]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КодПоставщика]"
                              cachedDataType="i8"
                              cachedName="КодПоставщика"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодПоставщика]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КодМагазина]"
                              cachedDataType="i8"
                              cachedName="КодМагазина"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КодМагазина]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ВидАсс]"
                              cachedDataType="ui1"
                              cachedName="ВидАсс"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ТОП]"
                              cachedDataType="bool"
                              cachedName="ТОП"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ТОП]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КоличествоОстаток]"
                              cachedDataType="numeric"
                              cachedName="КоличествоОстаток"
                              cachedPrecision="12"
                              cachedScale="3"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоОстаток]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоОстаток]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КоличествоПриход]"
                              cachedDataType="numeric"
                              cachedName="КоличествоПриход"
                              cachedPrecision="12"
                              cachedScale="3"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоПриход]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КоличествоПриход]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ПродажиШТ]"
                              cachedDataType="numeric"
                              cachedName="ПродажиШТ"
                              cachedPrecision="38"
                              cachedScale="5"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиШТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиШТ]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ПродажиРуб]"
                              cachedDataType="numeric"
                              cachedName="ПродажиРуб"
                              cachedPrecision="38"
                              cachedScale="5"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиРуб]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ПродажиРуб]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[КПТ]"
                              cachedDataType="numeric"
                              cachedName="КПТ"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КПТ]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[КПТ]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[ВидАсс14денейНазад]"
                              cachedDataType="ui1"
                              cachedName="ВидАсс14денейНазад"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс14днейНазад]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output].Columns[ВидАсс14денейНазад]" />
                            <inputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].Columns[Copy of ВидПоставки]"
                              cachedDataType="i2"
                              cachedName="Copy of ВидПоставки"
                              externalMetadataColumnId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Output].Columns[Copy of ВидПоставки]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Дата]"
                              dataType="dbTimeStamp"
                              name="Дата" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[Час]"
                              dataType="ui1"
                              name="Час" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодТовара]"
                              dataType="i8"
                              name="КодТовара" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодПоставщика]"
                              dataType="i8"
                              name="КодПоставщика" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КодМагазина]"
                              dataType="i8"
                              name="КодМагазина" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ТОП]"
                              dataType="bool"
                              name="ТОП" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоПриход]"
                              dataType="numeric"
                              name="КоличествоПриход"
                              precision="18"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КоличествоОстаток]"
                              dataType="numeric"
                              name="КоличествоОстаток"
                              precision="18"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиШТ]"
                              dataType="numeric"
                              name="ПродажиШТ"
                              precision="18"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ПродажиРуб]"
                              dataType="numeric"
                              name="ПродажиРуб"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс]"
                              dataType="ui1"
                              name="ВидАсс" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидАсс14днейНазад]"
                              dataType="ui1"
                              name="ВидАсс14днейНазад" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[ВидПоставки]"
                              dataType="i2"
                              name="ВидПоставки" />
                            <externalMetadataColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input].ExternalColumns[КПТ]"
                              dataType="ui1"
                              name="КПТ" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2.Paths[ADO NET Source Output]"
                      endId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Inputs[Data Conversion Input]"
                      name="ADO NET Source Output"
                      startId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники.Outputs[ADO NET Source Output]" />
                    <path
                      refId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2.Paths[Data Conversion Output]"
                      endId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1.Inputs[ADO NET Destination Input]"
                      name="Data Conversion Output"
                      startId="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов.Outputs[Data Conversion Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\КПТ\Формирование КПТ Онлайн\Удалить свод за период"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{69D52CED-B515-452E-ADB0-5DB958EBEAF9}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Удалить свод за период"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:LoggingOptions
                DTS:FilterKind="0" />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{CD278E12-79DA-401D-8D60-C39A84DA3CBE}"
                  SQLTask:SqlStatementSource="set datefirst 7&#xA;&#xA;declare @date as datetime&#xA;declare @dateN as datetime&#xA;declare @curdate as datetime&#xA;&#xA;set @curdate=convert(varchar(16), dateadd(day, -1, getdate()), 112)&#xA;&#xA;set @date =CASE &#xA;WHEN DATEPART(weekday, @curdate) = 1 THEN @curdate &#xA;WHEN DATEPART(weekday, @curdate) = 2 THEN dateadd(day, + 6, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 3 THEN dateadd(day, + 5, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 4 THEN dateadd(day, + 4, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 5 THEN dateadd(day, + 3, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 6 THEN dateadd(day, + 2, @curdate) &#xA;WHEN DATEPART(weekday, @curdate) = 7 THEN dateadd(day, + 1, @curdate)&#xA;END&#xA;set @dateN = dateadd(dd, -6, @date)&#xA;&#xA;delete &#xA;from &#xA;&#x9;t_fact_КПТ_по_часам&#xA;where&#xA;&#x9;Дата between @dateN and @date;&#xA;&#xA;delete &#xA;from &#xA;&#x9;t_fact_КПТ_по_ЧАСАМ_ВТ&#xA;where&#xA;&#x9;Дата between @dateN and @date;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\КПТ\Формирование КПТ Онлайн.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{D8F644DD-5D8A-49C7-AAD3-1995100B3D53}"
              DTS:From="Package\КПТ\Формирование КПТ Онлайн\Удалить свод за период"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\КПТ\Формирование КПТ Онлайн.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{2E502E4B-8FFC-4148-A7C7-BE17C24A7039}"
              DTS:From="Package\КПТ\Формирование КПТ Онлайн\Удалить свод за период"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\КПТ.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{13C93585-D307-4BA2-B711-D277D8393AF3}"
          DTS:From="Package\КПТ\ОТБРС"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\КПТ\Формирование КПТ Онлайн" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\КПТ.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{2ED24DEF-191F-44DB-A067-B4853718871E}"
          DTS:From="Package\КПТ\DWH Продажи"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\КПТ\Формирование КПТ Онлайн" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Расчет измерений куба КПТ"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Контейнер последовательности"
      DTS:DTSID="{4502251C-D296-4BA3-8174-9A846AFDBF32}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Расчет измерений куба КПТ">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Расчет измерений куба КПТ\Обработка измерений"
          DTS:CreationName="Microsoft.DTSProcessingTask"
          DTS:Description="Задача &quot;Обработка средствами Analysis Services&quot;"
          DTS:DTSID="{B1400EF3-D642-4754-AF49-B4AB989360FD}"
          DTS:ExecutableType="Microsoft.DTSProcessingTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Обработка измерений"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <ASProcessingData
              ConnectionName="s19-bi-db.KPT_prod"
              ProcessingCommands="&lt;Batch xmlns=&quot;http://schemas.microsoft.com/analysisservices/2003/engine&quot;&gt;&#xA;  &lt;Parallel&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Вид Ассортимента&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Магазины&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Товары&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Вид Ассортимента 1&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Виды Причин Падения КПТ&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;СТМ&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Поставщики&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Менеджер&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Сценарии ВТ&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;TOP&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;    &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot; xmlns:ddl500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500&quot; xmlns:ddl500_500=&quot;http://schemas.microsoft.com/analysisservices/2013/engine/500/500&quot;&gt;&#xA;      &lt;Object&gt;&#xA;        &lt;DatabaseID&gt;KPT_prod&lt;/DatabaseID&gt;&#xA;        &lt;DimensionID&gt;Товары 1&lt;/DimensionID&gt;&#xA;      &lt;/Object&gt;&#xA;      &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;      &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;    &lt;/Process&gt;&#xA;  &lt;/Parallel&gt;&#xA;&lt;/Batch&gt;" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{E625BFEE-D994-4D39-844C-E0C9EC319C39}"
      DTS:From="Package\КПТ"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Расчет измерений куба КПТ" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{2CEA9A95-5118-4AD9-BBD8-0175657C3483}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{616DD183-2A03-4A55-8DAF-7DD1FBC0DF93}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables />
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="136,44"
          Id="Package\КПТ\DWH Продажи\Очистка таблиц"
          TopLeft="35.466981132075,7.72169811320782" />
        <NodeLayout
          Size="244,42"
          Id="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)"
          TopLeft="31.495283018869,94.7924528301893" />
        <EdgeLayout
          Id="Package\КПТ\DWH Продажи.PrecedenceConstraints[Constraint 3]"
          TopLeft="103.466981132075,51.7216981132078">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="50.028301886794,43.0707547169815"
              Start="0,0"
              End="50.028301886794,35.5707547169815">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5353773584907" />
                  <mssgle:CubicBezierSegment
                    Point1="0,17.5353773584907"
                    Point2="0,21.5353773584907"
                    Point3="4,21.5353773584907" />
                  <mssgle:LineSegment
                    End="46.028301886794,21.5353773584907" />
                  <mssgle:CubicBezierSegment
                    Point1="46.028301886794,21.5353773584907"
                    Point2="50.028301886794,21.5353773584907"
                    Point3="50.028301886794,25.5353773584907" />
                  <mssgle:LineSegment
                    End="50.028301886794,35.5707547169815" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="300,161"
          Size="300,204"
          Id="Package\КПТ\DWH Продажи"
          TopLeft="1194,8.75" />
        <NodeLayout
          Size="187,72"
          Id="Package\КПТ\ОТБРС\Загрузка магазинов\s8-oalp-test Очистка таблицы Магазины_temp_load"
          TopLeft="28,5.5" />
        <NodeLayout
          Size="152,50"
          Id="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС"
          TopLeft="36.551886792452,103.834905660377" />
        <NodeLayout
          Size="189,44"
          Id="Package\КПТ\ОТБРС\Загрузка магазинов\Слияние таблиц магазины"
          TopLeft="29.6556603773579,179.495283018868" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка магазинов.PrecedenceConstraints[Constraint]"
          TopLeft="121.5,77.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-8.94811320754798,26.334905660377"
              Start="0,0"
              End="-8.94811320754798,18.834905660377">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,9.16745283018849" />
                  <mssgle:CubicBezierSegment
                    Point1="0,9.16745283018849"
                    Point2="0,13.1674528301885"
                    Point3="-4,13.1674528301885" />
                  <mssgle:LineSegment
                    End="-4.94811320754798,13.1674528301885" />
                  <mssgle:CubicBezierSegment
                    Point1="-4.94811320754798,13.1674528301885"
                    Point2="-8.94811320754798,13.1674528301885"
                    Point3="-8.94811320754798,17.1674528301885" />
                  <mssgle:LineSegment
                    End="-8.94811320754798,18.834905660377" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка магазинов.PrecedenceConstraints[Constraint 1]"
          TopLeft="112.551886792452,153.834905660377">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="11.6037735849059,25.660377358491"
              Start="0,0"
              End="11.6037735849059,18.160377358491">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,8.83018867924551" />
                  <mssgle:CubicBezierSegment
                    Point1="0,8.83018867924551"
                    Point2="0,12.8301886792455"
                    Point3="4,12.8301886792455" />
                  <mssgle:LineSegment
                    End="7.60377358490587,12.8301886792455" />
                  <mssgle:CubicBezierSegment
                    Point1="7.60377358490587,12.8301886792455"
                    Point2="11.6037735849059,12.8301886792455"
                    Point3="11.6037735849059,16.8301886792455" />
                  <mssgle:LineSegment
                    End="11.6037735849059,18.160377358491" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="224,273"
          Size="224,316"
          Id="Package\КПТ\ОТБРС\Загрузка магазинов"
          TopLeft="262.783018867926,4.5" />
        <NodeLayout
          Size="192,51"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\s8-oalp-test Очистка таблицы ОТБРС_Матрица"
          TopLeft="28.25,5.5" />
        <NodeLayout
          Size="202,49"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1"
          TopLeft="32.25,153" />
        <NodeLayout
          Size="184,42"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)"
          TopLeft="28,80.792452830189" />
        <NodeLayout
          Size="208,42"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Задача &quot;Выполнение SQL&quot;"
          TopLeft="36,245" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка матрицы.PrecedenceConstraints[Constraint]"
          TopLeft="122.125,56.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24.292452830189"
              Start="0,0"
              End="0,16.792452830189">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.792452830189" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка матрицы.PrecedenceConstraints[Constraint 1]"
          TopLeft="120,122.792452830189">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="13.25,30.207547169811"
              Start="0,0"
              End="13.25,22.707547169811">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,11.1037735849055" />
                  <mssgle:CubicBezierSegment
                    Point1="0,11.1037735849055"
                    Point2="0,15.1037735849055"
                    Point3="4,15.1037735849055" />
                  <mssgle:LineSegment
                    End="9.25,15.1037735849055" />
                  <mssgle:CubicBezierSegment
                    Point1="9.25,15.1037735849055"
                    Point2="13.25,15.1037735849055"
                    Point3="13.25,19.1037735849055" />
                  <mssgle:LineSegment
                    End="13.25,22.707547169811" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка матрицы.PrecedenceConstraints[Constraint 2]"
          TopLeft="136.625,202">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,43"
              Start="0,0"
              End="0,35.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,35.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="338,351"
          Size="338,394"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы"
          TopLeft="7,373.25" />
        <NodeLayout
          Size="182,62"
          Id="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС"
          TopLeft="9,106.792452830189" />
        <NodeLayout
          Size="185,76"
          Id="Package\КПТ\ОТБРС\Загрузка МК\Очистка таблицы маркетинговый классфикатор и добавление значения &quot;Не заполнено&quot;"
          TopLeft="8,5.5" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка МК.PrecedenceConstraints[Constraint]"
          TopLeft="100.25,81.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25.292452830189"
              Start="0,0"
              End="0,17.792452830189">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.792452830189" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="207,185"
          Size="207,228"
          Id="Package\КПТ\ОТБРС\Загрузка МК"
          TopLeft="709.5,6.75" />
        <NodeLayout
          Size="187,44"
          Id="Package\КПТ\ОТБРС\Загрузка товаров\s8-oalp-test Очистка таблицы Товары"
          TopLeft="11.6698113207543,9.19811320754729" />
        <NodeLayout
          Size="189,44"
          Id="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС"
          TopLeft="8.23113207547192,76.3396226415101" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка товаров.PrecedenceConstraints[Constraint]"
          TopLeft="103.950471698113,53.1981132075473">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23.1415094339628"
              Start="0,0"
              End="0,15.6415094339628">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.6415094339628" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="207,138"
          Size="207,181"
          Id="Package\КПТ\ОТБРС\Загрузка товаров"
          TopLeft="493.25,6.5" />
        <NodeLayout
          Size="228,44"
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков\s8-oalp-test Очистка таблицы Поставщики_temp_load"
          TopLeft="5.5,5.5" />
        <NodeLayout
          Size="229,44"
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС"
          TopLeft="4.95754716981105,73.533018867925" />
        <NodeLayout
          Size="225,44"
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков\Слияние таблиц поставщики"
          TopLeft="7.08018867924511,144.38679245283" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков.PrecedenceConstraints[Constraint]"
          TopLeft="119.478773584906,49.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24.033018867925"
              Start="0,0"
              End="0,16.533018867925">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.533018867925" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков.PrecedenceConstraints[Constraint 1]"
          TopLeft="119.518867924528,117.533018867925">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,26.853773584905"
              Start="0,0"
              End="0,19.353773584905">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.353773584905" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="242,201"
          Size="242,244"
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков"
          TopLeft="15.5,4.75" />
        <NodeLayout
          Size="212,42"
          Id="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный"
          TopLeft="111,123" />
        <NodeLayout
          Size="216,42"
          Id="Package\КПТ\ОТБРС\Контейнер последовательности\Очистка остатков от шляпы"
          TopLeft="99,20" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Контейнер последовательности.PrecedenceConstraints[Constraint]"
          TopLeft="207,62">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="10,61"
              Start="0,0"
              End="10,53.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,26.5"
                    Point2="0,30.5"
                    Point3="4,30.5" />
                  <mssgle:LineSegment
                    End="6,30.5" />
                  <mssgle:CubicBezierSegment
                    Point1="6,30.5"
                    Point2="10,30.5"
                    Point3="10,34.5" />
                  <mssgle:LineSegment
                    End="10,53.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="432,324"
          Size="432,367"
          Id="Package\КПТ\ОТБРС\Контейнер последовательности"
          TopLeft="525,379" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1093,822"
          Size="1093,865"
          Id="Package\КПТ\ОТБРС"
          TopLeft="11.5,10" />
        <NodeLayout
          Size="228,77"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1"
          TopLeft="6.5,170.5" />
        <NodeLayout
          Size="215,42"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2"
          TopLeft="243,207" />
        <NodeLayout
          Size="188,44"
          Id="Package\КПТ\Формирование КПТ Онлайн\Удалить свод за период"
          TopLeft="35.0707547169791,11.38679245283" />
        <EdgeLayout
          Id="Package\КПТ\Формирование КПТ Онлайн.PrecedenceConstraints[Constraint]"
          TopLeft="159.070754716979,55.38679245283">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="191.429245283021,151.61320754717"
              Start="0,0"
              End="191.429245283021,144.11320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,57.4129448292334" />
                  <mssgle:CubicBezierSegment
                    Point1="0,57.4129448292334"
                    Point2="0,61.4129448292334"
                    Point3="4,61.4129448292334" />
                  <mssgle:LineSegment
                    End="187.429245283021,61.4129448292334" />
                  <mssgle:CubicBezierSegment
                    Point1="187.429245283021,61.4129448292334"
                    Point2="191.429245283021,61.4129448292334"
                    Point3="191.429245283021,65.4129448292334" />
                  <mssgle:LineSegment
                    End="191.429245283021,144.11320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\Формирование КПТ Онлайн.PrecedenceConstraints[Constraint 3]"
          TopLeft="99.0707547169791,55.38679245283">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="21.4292452830209,115.11320754717"
              Start="0,0"
              End="21.4292452830209,107.61320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,42.6281347026511" />
                  <mssgle:CubicBezierSegment
                    Point1="0,42.6281347026511"
                    Point2="0,46.6281347026511"
                    Point3="4,46.6281347026511" />
                  <mssgle:LineSegment
                    End="17.4292452830209,46.6281347026511" />
                  <mssgle:CubicBezierSegment
                    Point1="17.4292452830209,46.6281347026511"
                    Point2="21.4292452830209,46.6281347026511"
                    Point3="21.4292452830209,50.6281347026511" />
                  <mssgle:LineSegment
                    End="21.4292452830209,107.61320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="463,376"
          Size="463,419"
          Id="Package\КПТ\Формирование КПТ Онлайн"
          TopLeft="1277,279" />
        <EdgeLayout
          Id="Package\КПТ.PrecedenceConstraints[Constraint]"
          TopLeft="1104.5,442.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="172.5,46"
              Start="0,0"
              End="165,46">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="82.25,0" />
                  <mssgle:CubicBezierSegment
                    Point1="82.25,0"
                    Point2="86.25,0"
                    Point3="86.25,4" />
                  <mssgle:LineSegment
                    End="86.25,42" />
                  <mssgle:CubicBezierSegment
                    Point1="86.25,42"
                    Point2="86.25,46"
                    Point3="90.25,46" />
                  <mssgle:LineSegment
                    End="165,46" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ.PrecedenceConstraints[Constraint 1]"
          TopLeft="1344,212.75">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="164.5,66.25"
              Start="0,0"
              End="164.5,58.75">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,29.125" />
                  <mssgle:CubicBezierSegment
                    Point1="0,29.125"
                    Point2="0,33.125"
                    Point3="4,33.125" />
                  <mssgle:LineSegment
                    End="160.5,33.125" />
                  <mssgle:CubicBezierSegment
                    Point1="160.5,33.125"
                    Point2="164.5,33.125"
                    Point3="164.5,37.125" />
                  <mssgle:LineSegment
                    End="164.5,58.75" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1788,962"
          Size="1788,1005"
          Id="Package\КПТ"
          TopLeft="85.75,6.5" />
        <NodeLayout
          Size="188,42"
          Id="Package\Расчет измерений куба КПТ\Обработка измерений"
          TopLeft="13,15" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="240,91"
          Size="240,134"
          Id="Package\Расчет измерений куба КПТ"
          TopLeft="2354,360" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="1873.75,509">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="480.25,-82"
              Start="0,0"
              End="472.75,-82">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="236.125,0" />
                  <mssgle:CubicBezierSegment
                    Point1="236.125,0"
                    Point2="240.125,0"
                    Point3="240.125,-4" />
                  <mssgle:LineSegment
                    End="240.125,-78" />
                  <mssgle:CubicBezierSegment
                    Point1="240.125,-78"
                    Point2="240.125,-82"
                    Point3="244.125,-82" />
                  <mssgle:LineSegment
                    End="472.75,-82" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <ConnectionManager
    design-time-name="Package.ConnectionManagers[s19-bi-db.KPT_prod]">
    <ProjectReferenceName></ProjectReferenceName>
  </ConnectionManager>
  <TaskHost
    design-time-name="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="212,42"
          Id="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи"
          TopLeft="146.292452830189,152.254716981132" />
        <NodeLayout
          Size="103,42"
          Id="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH"
          TopLeft="5.5,5.5" />
        <EdgeLayout
          Id="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ).Paths[ADO NET Source Output]"
          TopLeft="57,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="195.292452830189,104.754716981132"
              Start="0,0"
              End="195.292452830189,97.254716981132">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,48.377358490566" />
                  <mssgle:CubicBezierSegment
                    Point1="0,48.377358490566"
                    Point2="0,52.377358490566"
                    Point3="4,52.377358490566" />
                  <mssgle:LineSegment
                    End="191.292452830189,52.377358490566" />
                  <mssgle:CubicBezierSegment
                    Point1="191.292452830189,52.377358490566"
                    Point2="195.292452830189,52.377358490566"
                    Point3="195.292452830189,56.377358490566" />
                  <mssgle:LineSegment
                    End="195.292452830189,97.254716981132" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\DWH Продажи\Продажи OLAP (ОТБОР ПО ДАТЕ)\s8-olap-test OLAP_продажи">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="241,42"
          Id="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load"
          TopLeft="5.5,152.254716981132" />
        <NodeLayout
          Size="136,44"
          Id="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС"
          TopLeft="8.48113207547171,5.5" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС.Paths[ADO NET Source Output]"
          TopLeft="76.4811320754717,49.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="49.5188679245283,102.754716981132"
              Start="0,0"
              End="49.5188679245283,95.254716981132">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,47.377358490566" />
                  <mssgle:CubicBezierSegment
                    Point1="0,47.377358490566"
                    Point2="0,51.377358490566"
                    Point3="4,51.377358490566" />
                  <mssgle:LineSegment
                    End="45.5188679245283,51.377358490566" />
                  <mssgle:CubicBezierSegment
                    Point1="45.5188679245283,51.377358490566"
                    Point2="49.5188679245283,51.377358490566"
                    Point3="49.5188679245283,55.377358490566" />
                  <mssgle:LineSegment
                    End="49.5188679245283,95.254716981132" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\s8-olap-test Магазины_temp_load">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка магазинов\Загрузка магазинов из ОТБРС\ОТБРС">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="223,44"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица"
          TopLeft="50.4433962264151,129.311320754717" />
        <NodeLayout
          Size="103,42"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH"
          TopLeft="5.5,5.5" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1.Paths[ADO NET Source Output]"
          TopLeft="57,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="104.943396226415,81.811320754717"
              Start="0,0"
              End="104.943396226415,74.311320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.9056603773585" />
                  <mssgle:CubicBezierSegment
                    Point1="0,36.9056603773585"
                    Point2="0,40.9056603773585"
                    Point3="4,40.9056603773585" />
                  <mssgle:LineSegment
                    End="100.943396226415,40.9056603773585" />
                  <mssgle:CubicBezierSegment
                    Point1="100.943396226415,40.9056603773585"
                    Point2="104.943396226415,40.9056603773585"
                    Point3="104.943396226415,44.9056603773585" />
                  <mssgle:LineSegment
                    End="104.943396226415,74.311320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы  Признак 5 (отбор по дате) 1\s8-oalp-test ОТБРС_Матрица">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="223,44"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица"
          TopLeft="50.4433962264151,129.311320754717" />
        <NodeLayout
          Size="103,42"
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH"
          TopLeft="5.5,5.5" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате).Paths[ADO NET Source Output]"
          TopLeft="57,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="104.943396226415,81.811320754717"
              Start="0,0"
              End="104.943396226415,74.311320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.9056603773585" />
                  <mssgle:CubicBezierSegment
                    Point1="0,36.9056603773585"
                    Point2="0,40.9056603773585"
                    Point3="4,40.9056603773585" />
                  <mssgle:LineSegment
                    End="100.943396226415,40.9056603773585" />
                  <mssgle:CubicBezierSegment
                    Point1="100.943396226415,40.9056603773585"
                    Point2="104.943396226415,40.9056603773585"
                    Point3="104.943396226415,44.9056603773585" />
                  <mssgle:LineSegment
                    End="104.943396226415,74.311320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\DWH">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка матрицы\Загрузка матрицы из DWH (отбор по дате)\s8-oalp-test ОТБРС_Матрица">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="136,44"
          Id="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\ОТБРС"
          TopLeft="5.5,5.5" />
        <NodeLayout
          Size="536,44"
          Id="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор"
          TopLeft="102.330188679245,149.27358490566" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС.Paths[ADO NET Source Output]"
          TopLeft="73.3867924528302,49.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="297.018867924528,99.8490566037736"
              Start="0,0"
              End="297.018867924528,92.3490566037736">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,49.9245283018868" />
                  <mssgle:LineSegment
                    End="297.018867924528,49.9245283018868" />
                  <mssgle:LineSegment
                    End="297.018867924528,92.3490566037736" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка МК\Загрузка маркетингового классификатора из ОТБРС\s8-olap-test Маркетинговый классификатор">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="136,44"
          Id="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\Конвертация типов"
          TopLeft="194.216981132075,80.4056603773585" />
        <NodeLayout
          Size="174,42"
          Id="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары"
          TopLeft="13.5,155.27358490566" />
        <NodeLayout
          Size="136,44"
          Id="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\ОТБРС"
          TopLeft="5.5,5.5" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС.Paths[Data Conversion Output]"
          TopLeft="262.216981132075,124.405660377359">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-161.716981132075,30.8679245283015"
              Start="0,0"
              End="-161.716981132075,23.3679245283015">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,11.4339622641507" />
                  <mssgle:CubicBezierSegment
                    Point1="0,11.4339622641507"
                    Point2="0,15.4339622641507"
                    Point3="-4,15.4339622641507" />
                  <mssgle:LineSegment
                    End="-157.716981132075,15.4339622641507" />
                  <mssgle:CubicBezierSegment
                    Point1="-157.716981132075,15.4339622641507"
                    Point2="-161.716981132075,15.4339622641507"
                    Point3="-161.716981132075,19.4339622641507" />
                  <mssgle:LineSegment
                    End="-161.716981132075,23.3679245283015" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС.Paths[ADO NET Source Output]"
          TopLeft="73.3867924528302,49.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="188.716981132075,30.9811320754717"
              Start="0,0"
              End="188.716981132075,23.4811320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.4716981132076" />
                  <mssgle:LineSegment
                    End="188.716981132075,15.4716981132076" />
                  <mssgle:LineSegment
                    End="188.716981132075,23.4811320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Загрузка товаров\Загрузка товаров из ОТБРС\s8-olap-test Товары">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="136,44"
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\ОТБРС"
          TopLeft="5.5,5.5" />
        <NodeLayout
          Size="263,44"
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load"
          TopLeft="7.5,118.330188679245" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС.Paths[ADO NET Source Output]"
          TopLeft="73.3867924528302,49.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="65.3962264150943,68.9056603773585"
              Start="0,0"
              End="65.3962264150943,61.4056603773585">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.4528301886793" />
                  <mssgle:LineSegment
                    End="65.3962264150943,34.4528301886793" />
                  <mssgle:LineSegment
                    End="65.3962264150943,61.4056603773585" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Звгрузка поставщиков\Загрузка поставщиков из ОТБРС\s8-olap-test Поставщики_temp_load">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="185,42"
          Id="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET"
          TopLeft="457,327" />
        <NodeLayout
          Size="179,42"
          Id="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET"
          TopLeft="232,113" />
        <EdgeLayout
          Id="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный.Paths[Вывод источника ADO NET]"
          TopLeft="321.5,155">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="228,172"
              Start="0,0"
              End="228,164.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,82" />
                  <mssgle:CubicBezierSegment
                    Point1="0,82"
                    Point2="0,86"
                    Point3="4,86" />
                  <mssgle:LineSegment
                    End="224,86" />
                  <mssgle:CubicBezierSegment
                    Point1="224,86"
                    Point2="228,86"
                    Point3="228,90" />
                  <mssgle:LineSegment
                    End="228,164.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Источник - ADO NET">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\ОТБРС\Контейнер последовательности\Загрузка Остатков важный\Назначение ADO NET">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="215,42"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1"
          TopLeft="27.4622641509434,219.160377358491" />
        <NodeLayout
          Size="150,42"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники"
          TopLeft="14.4811320754717,5.5" />
        <NodeLayout
          Size="263,44"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Преобразование типов"
          TopLeft="5.5,108.330188679245" />
        <EdgeLayout
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1.Paths[Data Conversion Output]"
          TopLeft="135.981132075472,152.330188679245">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,66.830188679246"
              Start="0,0"
              End="0,59.330188679246">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,59.330188679246" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1.Paths[ADO NET Source Output]"
          TopLeft="89.4811320754717,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="47.5188679245283,60.830188679245"
              Start="0,0"
              End="47.5188679245283,53.330188679245">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.4150943396225" />
                  <mssgle:CubicBezierSegment
                    Point1="0,26.4150943396225"
                    Point2="0,30.4150943396225"
                    Point3="4,30.4150943396225" />
                  <mssgle:LineSegment
                    End="43.5188679245283,30.4150943396225" />
                  <mssgle:CubicBezierSegment
                    Point1="43.5188679245283,30.4150943396225"
                    Point2="47.5188679245283,30.4150943396225"
                    Point3="47.5188679245283,34.4150943396225" />
                  <mssgle:LineSegment
                    End="47.5188679245283,53.330188679245" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Свод_ступень_обработки_1">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_1\Все источники">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="215,42"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1"
          TopLeft="27.4622641509434,219.160377358491" />
        <NodeLayout
          Size="136,44"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники"
          TopLeft="13.4811320754717,8.5" />
        <NodeLayout
          Size="263,44"
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Преобразование типов"
          TopLeft="5.5,108.330188679245" />
        <EdgeLayout
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2.Paths[Data Conversion Output]"
          TopLeft="135.981132075472,152.330188679245">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,66.830188679246"
              Start="0,0"
              End="0,59.330188679246">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,59.330188679246" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2.Paths[ADO NET Source Output]"
          TopLeft="81.4811320754717,52.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="55.5188679245283,55.830188679245"
              Start="0,0"
              End="55.5188679245283,48.330188679245">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.9150943396225" />
                  <mssgle:CubicBezierSegment
                    Point1="0,23.9150943396225"
                    Point2="0,27.9150943396225"
                    Point3="4,27.9150943396225" />
                  <mssgle:LineSegment
                    End="51.5188679245283,27.9150943396225" />
                  <mssgle:CubicBezierSegment
                    Point1="51.5188679245283,27.9150943396225"
                    Point2="55.5188679245283,27.9150943396225"
                    Point3="55.5188679245283,31.9150943396225" />
                  <mssgle:LineSegment
                    End="55.5188679245283,48.330188679245" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Свод_ступень_обработки_1">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\КПТ\Формирование КПТ Онлайн\Свод_ступень_обработки_2\Все источники">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>